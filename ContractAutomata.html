<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>ContractAutomata</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/contract-automata/tree/master/ContractAutomata.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="25" class="Symbol">;</a> <a id="27" class="Keyword">open</a> <a id="32" href="Prelude.Init.html#397" class="Module">SetAsType</a>
<a id="42" class="Keyword">open</a> <a id="47" href="Prelude.Init.html#3367" class="Module">Nat</a> <a id="51" class="Keyword">using</a> <a id="57" class="Symbol">(</a><a id="58" href="Data.Nat.Base.html#3157" class="Function Operator">_⊓_</a><a id="61" class="Symbol">)</a>
<a id="63" class="Keyword">open</a> <a id="68" class="Keyword">import</a> <a id="75" href="Prelude.Sets.html" class="Module">Prelude.Sets</a>
<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="114" class="Keyword">open</a> <a id="119" class="Keyword">import</a> <a id="126" href="Prelude.InferenceRules.html" class="Module">Prelude.InferenceRules</a>
<a id="149" class="Keyword">open</a> <a id="154" class="Keyword">import</a> <a id="161" href="Prelude.Ord.html" class="Module">Prelude.Ord</a>
<a id="173" class="Keyword">open</a> <a id="178" class="Keyword">import</a> <a id="185" href="Prelude.Measurable.html" class="Module">Prelude.Measurable</a>
<a id="204" class="Keyword">open</a> <a id="209" class="Keyword">import</a> <a id="216" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>
<a id="234" class="Keyword">open</a> <a id="239" class="Keyword">import</a> <a id="246" href="Prelude.Null.html" class="Module">Prelude.Null</a>
<a id="259" class="Keyword">open</a> <a id="264" class="Keyword">import</a> <a id="271" href="Prelude.Setoid.html" class="Module">Prelude.Setoid</a>
<a id="286" class="Keyword">open</a> <a id="291" class="Keyword">import</a> <a id="298" href="Prelude.DecLists.html" class="Module">Prelude.DecLists</a>

<a id="316" class="Comment">-- ** Base DFA</a>

<a id="332" class="Keyword">data</a> <a id="State"></a><a id="337" href="ContractAutomata.html#337" class="Datatype">State</a> <a id="343" class="Symbol">:</a> <a id="345" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="350" class="Keyword">where</a>
  <a id="State.Holding"></a><a id="358" href="ContractAutomata.html#358" class="InductiveConstructor">Holding</a> <a id="State.Collecting"></a><a id="366" href="ContractAutomata.html#366" class="InductiveConstructor">Collecting</a> <a id="377" class="Symbol">:</a> <a id="379" href="ContractAutomata.html#337" class="Datatype">State</a>
<a id="385" class="Keyword">unquoteDecl</a> <a id="DecEq-S"></a><a id="397" href="ContractAutomata.html#397" class="Function">DecEq-S</a> <a id="405" class="Symbol">=</a> <a id="407" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="414" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="420" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="422" class="Keyword">quote</a> <a id="428" href="ContractAutomata.html#337" class="Datatype">State</a> <a id="434" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="436" href="ContractAutomata.html#397" class="Function">DecEq-S</a> <a id="444" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="447" class="Keyword">data</a> <a id="Label"></a><a id="452" href="ContractAutomata.html#452" class="Datatype">Label</a> <a id="458" class="Symbol">:</a> <a id="460" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="465" class="Keyword">where</a>
  <a id="Label.Propose"></a><a id="473" href="ContractAutomata.html#473" class="InductiveConstructor">Propose</a> <a id="Label.Add"></a><a id="481" href="ContractAutomata.html#481" class="InductiveConstructor">Add</a> <a id="Label.Pay"></a><a id="485" href="ContractAutomata.html#485" class="InductiveConstructor">Pay</a> <a id="Label.Cancel"></a><a id="489" href="ContractAutomata.html#489" class="InductiveConstructor">Cancel</a> <a id="496" class="Symbol">:</a> <a id="498" href="ContractAutomata.html#452" class="Datatype">Label</a>
<a id="504" class="Keyword">unquoteDecl</a> <a id="DecEq-L"></a><a id="516" href="ContractAutomata.html#516" class="Function">DecEq-L</a> <a id="524" class="Symbol">=</a> <a id="526" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="533" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="539" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="541" class="Keyword">quote</a> <a id="547" href="ContractAutomata.html#452" class="Datatype">Label</a> <a id="553" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="555" href="ContractAutomata.html#516" class="Function">DecEq-L</a> <a id="563" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="566" class="Keyword">data</a> <a id="_—[_]→_"></a><a id="571" href="ContractAutomata.html#571" class="Datatype Operator">_—[_]→_</a> <a id="579" class="Symbol">:</a> <a id="581" href="ContractAutomata.html#337" class="Datatype">State</a> <a id="587" class="Symbol">→</a> <a id="589" href="ContractAutomata.html#452" class="Datatype">Label</a> <a id="595" class="Symbol">→</a> <a id="597" href="ContractAutomata.html#337" class="Datatype">State</a> <a id="603" class="Symbol">→</a> <a id="605" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="610" class="Keyword">where</a>
  <a id="618" class="Keyword">instance</a>
    <a id="_—[_]→_.Propose"></a><a id="631" href="ContractAutomata.html#631" class="InductiveConstructor">Propose</a> <a id="639" class="Symbol">:</a> <a id="641" href="ContractAutomata.html#358" class="InductiveConstructor">Holding</a>    <a id="652" href="ContractAutomata.html#571" class="Datatype Operator">—[</a> <a id="655" href="ContractAutomata.html#473" class="InductiveConstructor">Propose</a> <a id="663" href="ContractAutomata.html#571" class="Datatype Operator">]→</a> <a id="666" href="ContractAutomata.html#366" class="InductiveConstructor">Collecting</a>
    <a id="_—[_]→_.Add"></a><a id="681" href="ContractAutomata.html#681" class="InductiveConstructor">Add</a>     <a id="689" class="Symbol">:</a> <a id="691" href="ContractAutomata.html#366" class="InductiveConstructor">Collecting</a> <a id="702" href="ContractAutomata.html#571" class="Datatype Operator">—[</a> <a id="705" href="ContractAutomata.html#481" class="InductiveConstructor">Add</a>     <a id="713" href="ContractAutomata.html#571" class="Datatype Operator">]→</a> <a id="716" href="ContractAutomata.html#366" class="InductiveConstructor">Collecting</a>
    <a id="_—[_]→_.Pay"></a><a id="731" href="ContractAutomata.html#731" class="InductiveConstructor">Pay</a>     <a id="739" class="Symbol">:</a> <a id="741" href="ContractAutomata.html#366" class="InductiveConstructor">Collecting</a> <a id="752" href="ContractAutomata.html#571" class="Datatype Operator">—[</a> <a id="755" href="ContractAutomata.html#485" class="InductiveConstructor">Pay</a>     <a id="763" href="ContractAutomata.html#571" class="Datatype Operator">]→</a> <a id="766" href="ContractAutomata.html#358" class="InductiveConstructor">Holding</a>
    <a id="_—[_]→_.Cancel"></a><a id="778" href="ContractAutomata.html#778" class="InductiveConstructor">Cancel</a>  <a id="786" class="Symbol">:</a> <a id="788" href="ContractAutomata.html#366" class="InductiveConstructor">Collecting</a> <a id="799" href="ContractAutomata.html#571" class="Datatype Operator">—[</a> <a id="802" href="ContractAutomata.html#489" class="InductiveConstructor">Cancel</a>  <a id="810" href="ContractAutomata.html#571" class="Datatype Operator">]→</a> <a id="813" href="ContractAutomata.html#358" class="InductiveConstructor">Holding</a>
<a id="821" class="Keyword">unquoteDecl</a> <a id="DecEq-—[]→"></a><a id="833" href="ContractAutomata.html#833" class="Function">DecEq-—[]→</a> <a id="844" class="Symbol">=</a> <a id="846" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="853" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="859" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="861" class="Keyword">quote</a> <a id="867" href="ContractAutomata.html#571" class="Datatype Operator">_—[_]→_</a> <a id="875" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="877" href="ContractAutomata.html#833" class="Function">DecEq-—[]→</a> <a id="888" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="Value"></a><a id="891" href="ContractAutomata.html#891" class="Function">Value</a> <a id="897" class="Symbol">=</a> <a id="899" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="900" class="Symbol">;</a> <a id="Key"></a><a id="902" href="ContractAutomata.html#902" class="Function">Key</a> <a id="906" class="Symbol">=</a> <a id="908" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="909" class="Symbol">;</a> <a id="KeyHash"></a><a id="911" href="ContractAutomata.html#911" class="Function">KeyHash</a> <a id="919" class="Symbol">=</a> <a id="921" href="ContractAutomata.html#902" class="Function">Key</a><a id="924" class="Symbol">;</a> <a id="Time"></a><a id="926" href="ContractAutomata.html#926" class="Function">Time</a> <a id="931" class="Symbol">=</a> <a id="933" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="936" class="Comment">-- ** Augmentation ↝ Configurations</a>

<a id="973" class="Keyword">record</a> <a id="Payment"></a><a id="980" href="ContractAutomata.html#980" class="Record">Payment</a> <a id="988" class="Symbol">:</a> <a id="990" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="995" class="Keyword">where</a>
  <a id="1003" class="Keyword">field</a> <a id="Payment.amount"></a><a id="1009" href="ContractAutomata.html#1009" class="Field">amount</a>    <a id="1019" class="Symbol">:</a> <a id="1021" href="ContractAutomata.html#891" class="Function">Value</a>
        <a id="Payment.recipient"></a><a id="1035" href="ContractAutomata.html#1035" class="Field">recipient</a> <a id="1045" class="Symbol">:</a> <a id="1047" href="ContractAutomata.html#902" class="Function">Key</a>
        <a id="Payment.deadline"></a><a id="1059" href="ContractAutomata.html#1059" class="Field">deadline</a>  <a id="1069" class="Symbol">:</a> <a id="1071" href="ContractAutomata.html#926" class="Function">Time</a>
<a id="1076" class="Keyword">open</a> <a id="1081" href="ContractAutomata.html#980" class="Module">Payment</a>
<a id="1089" class="Keyword">unquoteDecl</a> <a id="DecEq-Payment"></a><a id="1101" href="ContractAutomata.html#1101" class="Function">DecEq-Payment</a> <a id="1115" class="Symbol">=</a> <a id="1117" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="1124" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="1130" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1132" class="Keyword">quote</a> <a id="1138" href="ContractAutomata.html#980" class="Record">Payment</a> <a id="1146" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1148" href="ContractAutomata.html#1101" class="Function">DecEq-Payment</a> <a id="1162" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="1165" class="Keyword">record</a> <a id="Augmentable"></a><a id="1172" href="ContractAutomata.html#1172" class="Record">Augmentable</a> <a id="1184" class="Symbol">(</a><a id="1185" href="ContractAutomata.html#1185" class="Bound">A</a> <a id="1187" class="Symbol">:</a> <a id="1189" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="1193" class="Symbol">)</a> <a id="1195" class="Symbol">:</a> <a id="1197" href="Agda.Primitive.html#326" class="Primitive">Type₁</a> <a id="1203" class="Keyword">where</a>
  <a id="1211" class="Keyword">constructor</a> <a id="augment"></a><a id="1223" href="ContractAutomata.html#1223" class="InductiveConstructor">augment</a>
  <a id="1233" class="Keyword">field</a> <a id="Augmentable._⁺"></a><a id="1239" href="ContractAutomata.html#1239" class="Field Operator">_⁺</a> <a id="1242" class="Symbol">:</a> <a id="1244" href="Prelude.Init.html#12232" class="Function">Pred₀</a> <a id="1250" href="ContractAutomata.html#1185" class="Bound">A</a>
<a id="1252" class="Keyword">open</a> <a id="1257" href="ContractAutomata.html#1172" class="Module">Augmentable</a> <a id="1269" class="Symbol">⦃...⦄</a>

<a id="1276" class="Keyword">data</a> <a id="State⁺"></a><a id="1281" href="ContractAutomata.html#1281" class="Datatype">State⁺</a> <a id="1288" class="Symbol">:</a> <a id="1290" href="Prelude.Init.html#12232" class="Function">Pred₀</a> <a id="1296" href="ContractAutomata.html#337" class="Datatype">State</a> <a id="1302" class="Keyword">where</a>
  <a id="State⁺.Holding"></a><a id="1310" href="ContractAutomata.html#1310" class="InductiveConstructor">Holding</a>    <a id="1321" class="Symbol">:</a> <a id="1323" href="ContractAutomata.html#1281" class="Datatype">State⁺</a> <a id="1330" href="ContractAutomata.html#358" class="InductiveConstructor">Holding</a>
  <a id="State⁺.Collecting"></a><a id="1340" href="ContractAutomata.html#1340" class="InductiveConstructor">Collecting</a> <a id="1351" class="Symbol">:</a> <a id="1353" href="ContractAutomata.html#980" class="Record">Payment</a> <a id="1361" class="Symbol">→</a> <a id="1363" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">Set⟨</a> <a id="1368" href="ContractAutomata.html#911" class="Function">KeyHash</a> <a id="1376" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">⟩</a> <a id="1378" class="Symbol">→</a> <a id="1380" href="ContractAutomata.html#1281" class="Datatype">State⁺</a> <a id="1387" href="ContractAutomata.html#366" class="InductiveConstructor">Collecting</a>
<a id="1398" class="Keyword">unquoteDecl</a> <a id="DecEq-State⁺"></a><a id="1410" href="ContractAutomata.html#1410" class="Function">DecEq-State⁺</a> <a id="1423" class="Symbol">=</a> <a id="1425" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="1432" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="1438" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1440" class="Keyword">quote</a> <a id="1446" href="ContractAutomata.html#1281" class="Datatype">State⁺</a> <a id="1453" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1455" href="ContractAutomata.html#1410" class="Function">DecEq-State⁺</a> <a id="1468" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="1471" class="Keyword">data</a> <a id="Label⁺"></a><a id="1476" href="ContractAutomata.html#1476" class="Datatype">Label⁺</a> <a id="1483" class="Symbol">:</a> <a id="1485" href="Prelude.Init.html#12232" class="Function">Pred₀</a> <a id="1491" href="ContractAutomata.html#452" class="Datatype">Label</a> <a id="1497" class="Keyword">where</a>
  <a id="Label⁺.Propose"></a><a id="1505" href="ContractAutomata.html#1505" class="InductiveConstructor">Propose</a> <a id="1513" class="Symbol">:</a> <a id="1515" href="ContractAutomata.html#980" class="Record">Payment</a> <a id="1523" class="Symbol">→</a> <a id="1525" href="ContractAutomata.html#1476" class="Datatype">Label⁺</a> <a id="1532" href="ContractAutomata.html#473" class="InductiveConstructor">Propose</a>
  <a id="Label⁺.Add"></a><a id="1542" href="ContractAutomata.html#1542" class="InductiveConstructor">Add</a>     <a id="1550" class="Symbol">:</a> <a id="1552" href="ContractAutomata.html#911" class="Function">KeyHash</a> <a id="1560" class="Symbol">→</a> <a id="1562" href="ContractAutomata.html#1476" class="Datatype">Label⁺</a> <a id="1569" href="ContractAutomata.html#481" class="InductiveConstructor">Add</a>
  <a id="Label⁺.Pay"></a><a id="1575" href="ContractAutomata.html#1575" class="InductiveConstructor">Pay</a>     <a id="1583" class="Symbol">:</a> <a id="1585" href="ContractAutomata.html#1476" class="Datatype">Label⁺</a> <a id="1592" href="ContractAutomata.html#485" class="InductiveConstructor">Pay</a>
  <a id="Label⁺.Cancel"></a><a id="1598" href="ContractAutomata.html#1598" class="InductiveConstructor">Cancel</a>  <a id="1606" class="Symbol">:</a> <a id="1608" href="ContractAutomata.html#1476" class="Datatype">Label⁺</a> <a id="1615" href="ContractAutomata.html#489" class="InductiveConstructor">Cancel</a>
<a id="1622" class="Keyword">unquoteDecl</a> <a id="DecEq-Label⁺"></a><a id="1634" href="ContractAutomata.html#1634" class="Function">DecEq-Label⁺</a> <a id="1647" class="Symbol">=</a> <a id="1649" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="1656" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="1662" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1664" class="Keyword">quote</a> <a id="1670" href="ContractAutomata.html#1476" class="Datatype">Label⁺</a> <a id="1677" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1679" href="ContractAutomata.html#1634" class="Function">DecEq-Label⁺</a> <a id="1692" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="1695" class="Keyword">instance</a> <a id="Aug-State"></a><a id="1704" href="ContractAutomata.html#1704" class="Function">Aug-State</a> <a id="1714" class="Symbol">=</a> <a id="1716" href="ContractAutomata.html#1223" class="InductiveConstructor">augment</a> <a id="1724" href="ContractAutomata.html#1281" class="Datatype">State⁺</a>
         <a id="Aug-Label"></a><a id="1740" href="ContractAutomata.html#1740" class="Function">Aug-Label</a> <a id="1750" class="Symbol">=</a> <a id="1752" href="ContractAutomata.html#1223" class="InductiveConstructor">augment</a> <a id="1760" href="ContractAutomata.html#1476" class="Datatype">Label⁺</a>

<a id="Message"></a><a id="1768" href="ContractAutomata.html#1768" class="Function">Message</a> <a id="1776" class="Symbol">=</a> <a id="1778" href="ContractAutomata.html#891" class="Function">Value</a> <a id="1784" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1786" href="ContractAutomata.html#911" class="Function">KeyHash</a>

<a id="mkPayment"></a><a id="1795" href="ContractAutomata.html#1795" class="Function">mkPayment</a> <a id="1805" class="Symbol">:</a> <a id="1807" href="ContractAutomata.html#980" class="Record">Payment</a> <a id="1815" class="Symbol">→</a> <a id="1817" href="ContractAutomata.html#1768" class="Function">Message</a>
<a id="1825" href="ContractAutomata.html#1795" class="Function">mkPayment</a> <a id="1835" href="ContractAutomata.html#1835" class="Bound">p</a> <a id="1837" class="Symbol">=</a> <a id="1839" href="ContractAutomata.html#1835" class="Bound">p</a> <a id="1841" class="Symbol">.</a><a id="1842" href="ContractAutomata.html#1009" class="Field">amount</a> <a id="1849" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1851" href="ContractAutomata.html#1835" class="Bound">p</a> <a id="1853" class="Symbol">.</a><a id="1854" href="ContractAutomata.html#1035" class="Field">recipient</a>

<a id="1865" class="Keyword">record</a> <a id="Duration"></a><a id="1872" href="ContractAutomata.html#1872" class="Record">Duration</a> <a id="1881" class="Symbol">:</a> <a id="1883" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1888" class="Keyword">where</a>
  <a id="1896" class="Keyword">constructor</a> <a id="_,_"></a><a id="1908" href="ContractAutomata.html#1908" class="InductiveConstructor Operator">_,_</a>
  <a id="1914" class="Keyword">field</a> <a id="Duration.start"></a><a id="1920" href="ContractAutomata.html#1920" class="Field">start</a> <a id="1926" class="Symbol">:</a> <a id="1928" href="ContractAutomata.html#926" class="Function">Time</a>
        <a id="Duration.end"></a><a id="1941" href="ContractAutomata.html#1941" class="Field">end</a>   <a id="1947" class="Symbol">:</a> <a id="1949" href="ContractAutomata.html#926" class="Function">Time</a>
<a id="1954" class="Keyword">open</a> <a id="1959" href="ContractAutomata.html#1872" class="Module">Duration</a>
<a id="1968" class="Keyword">unquoteDecl</a> <a id="DecEq-Duration"></a><a id="1980" href="ContractAutomata.html#1980" class="Function">DecEq-Duration</a> <a id="1995" class="Symbol">=</a> <a id="1997" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="2004" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="2010" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="2012" class="Keyword">quote</a> <a id="2018" href="ContractAutomata.html#1872" class="Record">Duration</a> <a id="2027" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2029" href="ContractAutomata.html#1980" class="Function">DecEq-Duration</a> <a id="2044" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="2047" class="Keyword">module</a> <a id="def"></a><a id="2054" href="ContractAutomata.html#2054" class="Module">def</a> <a id="2058" class="Keyword">where</a>
  <a id="def.inputs"></a><a id="2066" href="ContractAutomata.html#2066" class="Function">inputs</a>  <a id="2074" class="Symbol">=</a> <a id="2076" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2081" href="ContractAutomata.html#1768" class="Function">Message</a> <a id="2089" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="2091" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="def.outputs"></a><a id="2096" href="ContractAutomata.html#2096" class="Function">outputs</a> <a id="2104" class="Symbol">=</a> <a id="2106" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2111" href="ContractAutomata.html#1768" class="Function">Message</a> <a id="2119" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="2121" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="def.signers"></a><a id="2126" href="ContractAutomata.html#2126" class="Function">signers</a> <a id="2134" class="Symbol">=</a> <a id="2136" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">Set⟨</a> <a id="2141" href="ContractAutomata.html#911" class="Function">KeyHash</a> <a id="2149" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">⟩</a> <a id="2151" href="Function.Base.html#4562" class="Function Operator">∋</a> <a id="2153" href="Prelude.Sets.AsUniqueLists.Core.html#2531" class="InductiveConstructor">∅</a>
<a id="2155" class="Keyword">module</a> <a id="defWith"></a><a id="2162" href="ContractAutomata.html#2162" class="Module">defWith</a> <a id="2170" class="Symbol">(</a><a id="2171" href="ContractAutomata.html#2171" class="Bound">v</a> <a id="2173" class="Symbol">:</a> <a id="2175" href="ContractAutomata.html#891" class="Function">Value</a><a id="2180" class="Symbol">)</a> <a id="2182" class="Symbol">(</a><a id="2183" href="ContractAutomata.html#2183" class="Bound">d</a> <a id="2185" class="Symbol">:</a> <a id="2187" href="ContractAutomata.html#1872" class="Record">Duration</a><a id="2195" class="Symbol">)</a> <a id="2197" class="Keyword">where</a>
  <a id="2205" class="Keyword">open</a> <a id="2210" href="ContractAutomata.html#2054" class="Module">def</a> <a id="2214" class="Keyword">public</a>
  <a id="defWith.value"></a><a id="2223" href="ContractAutomata.html#2223" class="Function">value</a> <a id="2229" class="Symbol">=</a> <a id="2231" href="ContractAutomata.html#2171" class="Bound">v</a>
  <a id="defWith.duration"></a><a id="2235" href="ContractAutomata.html#2235" class="Function">duration</a> <a id="2244" class="Symbol">=</a> <a id="2246" href="ContractAutomata.html#2183" class="Bound">d</a>
<a id="2248" class="Keyword">record</a> <a id="Conf"></a><a id="2255" href="ContractAutomata.html#2255" class="Record">Conf</a> <a id="2260" class="Symbol">(</a><a id="2261" href="ContractAutomata.html#2261" class="Bound">s</a> <a id="2263" class="Symbol">:</a> <a id="2265" href="ContractAutomata.html#337" class="Datatype">State</a><a id="2270" class="Symbol">)</a> <a id="2272" class="Symbol">:</a> <a id="2274" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="2279" class="Keyword">where</a>
  <a id="2287" class="Keyword">field</a> <a id="Conf.state"></a><a id="2293" href="ContractAutomata.html#2293" class="Field">state</a> <a id="2299" class="Symbol">:</a> <a id="2301" href="ContractAutomata.html#2261" class="Bound">s</a> <a id="2303" href="ContractAutomata.html#1239" class="Field Operator">⁺</a>
        <a id="Conf.value"></a><a id="2313" href="ContractAutomata.html#2313" class="Field">value</a> <a id="2319" class="Symbol">:</a> <a id="2321" href="ContractAutomata.html#891" class="Function">Value</a>
        <a id="Conf.inputs"></a><a id="2335" href="ContractAutomata.html#2335" class="Field">inputs</a> <a id="2342" class="Symbol">:</a> <a id="2344" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2349" href="ContractAutomata.html#1768" class="Function">Message</a>
        <a id="Conf.outputs"></a><a id="2365" href="ContractAutomata.html#2365" class="Field">outputs</a> <a id="2373" class="Symbol">:</a> <a id="2375" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2380" href="ContractAutomata.html#1768" class="Function">Message</a>
        <a id="Conf.duration"></a><a id="2396" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="2405" class="Symbol">:</a> <a id="2407" href="ContractAutomata.html#1872" class="Record">Duration</a>
        <a id="Conf.signers"></a><a id="2424" href="ContractAutomata.html#2424" class="Field">signers</a> <a id="2432" class="Symbol">:</a> <a id="2434" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">Set⟨</a> <a id="2439" href="ContractAutomata.html#911" class="Function">KeyHash</a> <a id="2447" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">⟩</a>
<a id="2449" class="Keyword">open</a> <a id="2454" href="ContractAutomata.html#2255" class="Module">Conf</a>
<a id="2459" class="Keyword">unquoteDecl</a> <a id="DecEq-Conf"></a><a id="2471" href="ContractAutomata.html#2471" class="Function">DecEq-Conf</a> <a id="2482" class="Symbol">=</a> <a id="2484" href="Prelude.Generics.html#9852" class="Function">DERIVE</a> <a id="2491" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="2497" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="2499" class="Keyword">quote</a> <a id="2505" href="ContractAutomata.html#2255" class="Record">Conf</a> <a id="2510" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2512" href="ContractAutomata.html#2471" class="Function">DecEq-Conf</a> <a id="2523" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="2526" class="Keyword">postulate</a>
  <a id="startTime"></a><a id="2538" href="ContractAutomata.html#2538" class="Postulate">startTime</a> <a id="standardInterval"></a><a id="2548" href="ContractAutomata.html#2548" class="Postulate">standardInterval</a> <a id="2565" class="Symbol">:</a> <a id="2567" href="ContractAutomata.html#926" class="Function">Time</a>
  <a id="owner"></a><a id="2574" href="ContractAutomata.html#2574" class="Postulate">owner</a> <a id="2580" class="Symbol">:</a> <a id="2582" href="ContractAutomata.html#911" class="Function">KeyHash</a>
  <a id="authorizedKeys"></a><a id="2592" href="ContractAutomata.html#2592" class="Postulate">authorizedKeys</a> <a id="2607" class="Symbol">:</a> <a id="2609" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">Set⟨</a> <a id="2614" href="ContractAutomata.html#911" class="Function">KeyHash</a> <a id="2622" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">⟩</a>
  <a id="noRequiredSignatures"></a><a id="2626" href="ContractAutomata.html#2626" class="Postulate">noRequiredSignatures</a> <a id="2647" class="Symbol">:</a> <a id="2649" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="initial"></a><a id="2652" href="ContractAutomata.html#2652" class="Function">initial</a> <a id="2660" class="Symbol">:</a> <a id="2662" href="ContractAutomata.html#891" class="Function">Value</a> <a id="2668" class="Symbol">→</a> <a id="2670" href="ContractAutomata.html#2255" class="Record">Conf</a> <a id="2675" class="InductiveConstructor">Holding</a>
<a id="2683" href="ContractAutomata.html#2652" class="Function">initial</a> <a id="2691" href="ContractAutomata.html#2691" class="Bound">val</a> <a id="2695" class="Symbol">=</a> <a id="2697" class="Keyword">record</a>
  <a id="2706" class="Symbol">{</a> <a id="2708" href="ContractAutomata.html#2293" class="Field">state</a> <a id="2714" class="Symbol">=</a> <a id="2716" href="ContractAutomata.html#1310" class="InductiveConstructor">Holding</a>
  <a id="2726" class="Symbol">;</a> <a id="2728" href="ContractAutomata.html#2313" class="Field">value</a> <a id="2734" class="Symbol">=</a> <a id="2736" href="ContractAutomata.html#2691" class="Bound">val</a>
  <a id="2742" class="Symbol">;</a> <a id="2744" href="ContractAutomata.html#2335" class="Field">inputs</a> <a id="2751" class="Symbol">=</a> <a id="2753" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="2755" href="ContractAutomata.html#2691" class="Bound">val</a> <a id="2759" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2761" href="ContractAutomata.html#2574" class="Postulate">owner</a> <a id="2767" href="Data.List.Base.html#5025" class="Function Operator">]</a>
  <a id="2771" class="Symbol">;</a> <a id="2773" href="ContractAutomata.html#2365" class="Field">outputs</a> <a id="2781" class="Symbol">=</a> <a id="2783" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="2788" class="Symbol">;</a> <a id="2790" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="2799" class="Symbol">=</a> <a id="2801" href="ContractAutomata.html#2538" class="Postulate">startTime</a> <a id="2811" href="ContractAutomata.html#1908" class="InductiveConstructor Operator">,</a> <a id="2813" href="ContractAutomata.html#2538" class="Postulate">startTime</a>
  <a id="2825" class="Symbol">;</a> <a id="2827" href="ContractAutomata.html#2424" class="Field">signers</a> <a id="2835" class="Symbol">=</a> <a id="2837" href="Prelude.Sets.AsUniqueLists.Core.html#2544" class="Function">singleton</a> <a id="2847" href="ContractAutomata.html#2574" class="Postulate">owner</a>
  <a id="2855" class="Symbol">}</a>

<a id="2858" class="Keyword">private</a> <a id="2866" class="Keyword">variable</a>
  <a id="2877" href="ContractAutomata.html#2877" class="Generalizable">t</a> <a id="2879" href="ContractAutomata.html#2879" class="Generalizable">t′</a> <a id="2882" class="Symbol">:</a> <a id="2884" href="ContractAutomata.html#926" class="Function">Time</a>
  <a id="2891" href="ContractAutomata.html#2891" class="Generalizable">s</a> <a id="2893" href="ContractAutomata.html#2893" class="Generalizable">s′</a> <a id="2896" class="Symbol">:</a> <a id="2898" href="ContractAutomata.html#337" class="Datatype">State</a>
  <a id="2906" href="ContractAutomata.html#2906" class="Generalizable">l</a> <a id="2908" href="ContractAutomata.html#2908" class="Generalizable">l′</a> <a id="2911" class="Symbol">:</a> <a id="2913" href="ContractAutomata.html#452" class="Datatype">Label</a>
  <a id="2921" href="ContractAutomata.html#2921" class="Generalizable">v</a> <a id="2923" href="ContractAutomata.html#2923" class="Generalizable">v′</a> <a id="2926" class="Symbol">:</a> <a id="2928" href="ContractAutomata.html#891" class="Function">Value</a>
  <a id="2936" href="ContractAutomata.html#2936" class="Generalizable">d</a> <a id="2938" href="ContractAutomata.html#2938" class="Generalizable">d′</a> <a id="2941" class="Symbol">:</a> <a id="2943" href="ContractAutomata.html#1872" class="Record">Duration</a>
  <a id="2954" href="ContractAutomata.html#2954" class="Generalizable">sgs</a> <a id="2958" href="ContractAutomata.html#2958" class="Generalizable">sgs′</a> <a id="2963" href="ContractAutomata.html#2963" class="Generalizable">keys</a> <a id="2968" href="ContractAutomata.html#2968" class="Generalizable">keys′</a> <a id="2974" class="Symbol">:</a> <a id="2976" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">Set⟨</a> <a id="2981" href="ContractAutomata.html#911" class="Function">KeyHash</a> <a id="2989" href="Prelude.Sets.AsUniqueLists.Core.html#917" class="Record">⟩</a>
  <a id="2993" href="ContractAutomata.html#2993" class="Generalizable">payment</a> <a id="3001" href="ContractAutomata.html#3001" class="Generalizable">payment′</a> <a id="3010" class="Symbol">:</a> <a id="3012" href="ContractAutomata.html#980" class="Record">Payment</a>
  <a id="3022" href="ContractAutomata.html#3022" class="Generalizable">key</a> <a id="3026" href="ContractAutomata.html#3026" class="Generalizable">key′</a> <a id="3031" class="Symbol">:</a> <a id="3033" href="ContractAutomata.html#902" class="Function">Key</a>

<a id="3038" class="Comment">-- ** Configuration Relation</a>

<a id="3068" class="Keyword">data</a> <a id="_⇒⟨_⟩_"></a><a id="3073" href="ContractAutomata.html#3073" class="Datatype Operator">_⇒⟨_⟩_</a> <a id="3080" class="Symbol">:</a> <a id="3082" class="Symbol">(</a><a id="3083" href="ContractAutomata.html#3083" class="Bound">src</a> <a id="3087" class="Symbol">:</a> <a id="3089" href="ContractAutomata.html#2255" class="Record">Conf</a> <a id="3094" href="ContractAutomata.html#2891" class="Generalizable">s</a><a id="3095" class="Symbol">)</a> <a id="3097" class="Symbol">→</a> <a id="3099" href="ContractAutomata.html#2906" class="Generalizable">l</a> <a id="3101" href="ContractAutomata.html#1239" class="Field Operator">⁺</a> <a id="3103" class="Symbol">→</a> <a id="3105" class="Symbol">(</a><a id="3106" href="ContractAutomata.html#3106" class="Bound">dst</a> <a id="3110" class="Symbol">:</a> <a id="3112" href="ContractAutomata.html#2255" class="Record">Conf</a> <a id="3117" href="ContractAutomata.html#2893" class="Generalizable">s′</a><a id="3119" class="Symbol">)</a>
            <a id="3133" class="Symbol">→</a> <a id="3135" class="Symbol">⦃</a> <a id="3137" href="ContractAutomata.html#2891" class="Generalizable">s</a> <a id="3139" href="ContractAutomata.html#571" class="Datatype Operator">—[</a> <a id="3142" href="ContractAutomata.html#2906" class="Generalizable">l</a> <a id="3144" href="ContractAutomata.html#571" class="Datatype Operator">]→</a> <a id="3147" href="ContractAutomata.html#2893" class="Generalizable">s′</a> <a id="3150" class="Symbol">⦄</a>
            <a id="3164" class="Symbol">→</a> <a id="3166" class="Symbol">⦃</a> <a id="3168" href="ContractAutomata.html#3083" class="Bound">src</a> <a id="3172" class="Symbol">.</a><a id="3173" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="3182" class="Symbol">.</a><a id="3183" href="ContractAutomata.html#1941" class="Field">end</a> <a id="3187" href="Prelude.Ord.html#271" class="Field Operator">&lt;</a> <a id="3189" href="ContractAutomata.html#3106" class="Bound">dst</a> <a id="3193" class="Symbol">.</a><a id="3194" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="3203" class="Symbol">.</a><a id="3204" href="ContractAutomata.html#1941" class="Field">end</a> <a id="3208" class="Symbol">⦄</a>
            <a id="3222" class="Symbol">→</a> <a id="3224" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="3229" class="Keyword">where</a>

  <a id="_⇒⟨_⟩_.Propose"></a><a id="3238" href="ContractAutomata.html#3238" class="InductiveConstructor">Propose</a> <a id="3246" class="Symbol">:</a> <a id="3248" class="Symbol">∀</a> <a id="3250" class="Symbol">(</a><a id="3251" href="ContractAutomata.html#3251" class="Bound">d&lt;</a> <a id="3254" class="Symbol">:</a> <a id="3256" href="ContractAutomata.html#2936" class="Generalizable">d</a> <a id="3258" class="Symbol">.</a><a id="3259" href="ContractAutomata.html#1941" class="Field">end</a> <a id="3263" href="Prelude.Ord.html#271" class="Field Operator">&lt;</a> <a id="3265" href="ContractAutomata.html#2938" class="Generalizable">d′</a> <a id="3268" class="Symbol">.</a><a id="3269" href="ContractAutomata.html#1941" class="Field">end</a><a id="3272" class="Symbol">)</a> <a id="3274" class="Symbol">→</a> <a id="3276" class="Keyword">let</a> <a id="3280" class="Keyword">instance</a> <a id="3289" href="ContractAutomata.html#3289" class="Bound">_</a> <a id="3291" class="Symbol">=</a> <a id="3293" href="ContractAutomata.html#3251" class="Bound">d&lt;</a> <a id="3296" class="Keyword">in</a>
    <a id="3303" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="3305" href="ContractAutomata.html#2993" class="Generalizable">payment</a> <a id="3313" class="Symbol">.</a><a id="3314" href="ContractAutomata.html#1009" class="Field">amount</a> <a id="3321" href="Prelude.Ord.html#267" class="Field Operator">≤</a> <a id="3323" href="ContractAutomata.html#2921" class="Generalizable">v</a>
    <a id="3329" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="3331" href="ContractAutomata.html#2993" class="Generalizable">payment</a> <a id="3339" class="Symbol">.</a><a id="3340" href="ContractAutomata.html#1059" class="Field">deadline</a> <a id="3349" href="Prelude.Ord.html#339" class="Function Operator">&gt;</a> <a id="3351" href="ContractAutomata.html#2938" class="Generalizable">d′</a> <a id="3354" class="Symbol">.</a><a id="3355" href="ContractAutomata.html#1941" class="Field">end</a>
      <a id="3365" href="Prelude.InferenceRules.html#12844" class="Function Operator">───────────────────────────────────────────────────</a>
      <a id="3423" class="Keyword">record</a> <a id="3430" class="Symbol">{</a><a id="3431" href="ContractAutomata.html#3431" class="Module">defWith</a> <a id="3439" href="ContractAutomata.html#2921" class="Generalizable">v</a> <a id="3441" href="ContractAutomata.html#2936" class="Generalizable">d</a><a id="3442" class="Symbol">;</a> <a id="3444" href="ContractAutomata.html#2293" class="Field">state</a> <a id="3450" class="Symbol">=</a> <a id="3452" href="ContractAutomata.html#1310" class="InductiveConstructor">Holding</a><a id="3459" class="Symbol">}</a>
      <a id="3467" href="ContractAutomata.html#3073" class="Datatype Operator">⇒⟨</a> <a id="3470" href="ContractAutomata.html#1505" class="InductiveConstructor">Propose</a> <a id="3478" href="ContractAutomata.html#2993" class="Generalizable">payment</a> <a id="3486" href="ContractAutomata.html#3073" class="Datatype Operator">⟩</a>
      <a id="3494" class="Keyword">record</a> <a id="3501" class="Symbol">{</a><a id="3502" href="ContractAutomata.html#3502" class="Module">defWith</a> <a id="3510" href="ContractAutomata.html#2921" class="Generalizable">v</a> <a id="3512" href="ContractAutomata.html#2938" class="Generalizable">d′</a><a id="3514" class="Symbol">;</a> <a id="3516" href="ContractAutomata.html#2293" class="Field">state</a> <a id="3522" class="Symbol">=</a> <a id="3524" href="ContractAutomata.html#1340" class="InductiveConstructor">Collecting</a> <a id="3535" href="ContractAutomata.html#2993" class="Generalizable">payment</a> <a id="3543" href="Prelude.Sets.AsUniqueLists.Core.html#2531" class="InductiveConstructor">∅</a><a id="3544" class="Symbol">}</a>

  <a id="_⇒⟨_⟩_.Add"></a><a id="3549" href="ContractAutomata.html#3549" class="InductiveConstructor">Add</a> <a id="3553" class="Symbol">:</a> <a id="3555" class="Symbol">∀</a> <a id="3557" class="Symbol">(</a><a id="3558" href="ContractAutomata.html#3558" class="Bound">d&lt;</a> <a id="3561" class="Symbol">:</a> <a id="3563" href="ContractAutomata.html#2936" class="Generalizable">d</a> <a id="3565" class="Symbol">.</a><a id="3566" href="ContractAutomata.html#1941" class="Field">end</a> <a id="3570" href="Prelude.Ord.html#271" class="Field Operator">&lt;</a> <a id="3572" href="ContractAutomata.html#2938" class="Generalizable">d′</a> <a id="3575" class="Symbol">.</a><a id="3576" href="ContractAutomata.html#1941" class="Field">end</a><a id="3579" class="Symbol">)</a> <a id="3581" class="Symbol">→</a> <a id="3583" class="Keyword">let</a> <a id="3587" class="Keyword">instance</a> <a id="3596" href="ContractAutomata.html#3596" class="Bound">_</a> <a id="3598" class="Symbol">=</a> <a id="3600" href="ContractAutomata.html#3558" class="Bound">d&lt;</a> <a id="3603" class="Keyword">in</a>
    <a id="3610" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="3612" href="ContractAutomata.html#3022" class="Generalizable">key</a> <a id="3616" href="Prelude.Sets.AsUniqueLists.Core.html#1858" class="Function Operator">∈ˢ</a> <a id="3619" href="ContractAutomata.html#2592" class="Postulate">authorizedKeys</a>
      <a id="3640" href="Prelude.InferenceRules.html#12295" class="Function Operator">────────────────────────────────────────────────────────────</a>
      <a id="3707" class="Keyword">record</a> <a id="3714" class="Symbol">{</a> <a id="3716" href="ContractAutomata.html#3716" class="Module">defWith</a> <a id="3724" href="ContractAutomata.html#2921" class="Generalizable">v</a> <a id="3726" href="ContractAutomata.html#2936" class="Generalizable">d</a><a id="3727" class="Symbol">;</a> <a id="3729" href="ContractAutomata.html#2424" class="Field">signers</a> <a id="3737" class="Symbol">=</a> <a id="3739" href="ContractAutomata.html#2954" class="Generalizable">sgs</a>
             <a id="3756" class="Symbol">;</a> <a id="3758" href="ContractAutomata.html#2293" class="Field">state</a> <a id="3764" class="Symbol">=</a> <a id="3766" href="ContractAutomata.html#1340" class="InductiveConstructor">Collecting</a> <a id="3777" href="ContractAutomata.html#2993" class="Generalizable">payment</a> <a id="3785" href="ContractAutomata.html#2963" class="Generalizable">keys</a> <a id="3790" class="Symbol">}</a>
      <a id="3798" href="ContractAutomata.html#3073" class="Datatype Operator">⇒⟨</a> <a id="3801" href="ContractAutomata.html#1542" class="InductiveConstructor">Add</a> <a id="3805" href="ContractAutomata.html#3022" class="Generalizable">key</a> <a id="3809" href="ContractAutomata.html#3073" class="Datatype Operator">⟩</a>
      <a id="3817" class="Keyword">record</a> <a id="3824" class="Symbol">{</a> <a id="3826" href="ContractAutomata.html#3826" class="Module">defWith</a> <a id="3834" href="ContractAutomata.html#2921" class="Generalizable">v</a> <a id="3836" href="ContractAutomata.html#2938" class="Generalizable">d′</a><a id="3838" class="Symbol">;</a> <a id="3840" href="ContractAutomata.html#2424" class="Field">signers</a> <a id="3848" class="Symbol">=</a> <a id="3850" href="ContractAutomata.html#2958" class="Generalizable">sgs′</a>
             <a id="3868" class="Symbol">;</a> <a id="3870" href="ContractAutomata.html#2293" class="Field">state</a> <a id="3876" class="Symbol">=</a> <a id="3878" href="ContractAutomata.html#1340" class="InductiveConstructor">Collecting</a> <a id="3889" href="ContractAutomata.html#2993" class="Generalizable">payment</a> <a id="3897" class="Symbol">(</a><a id="3898" href="ContractAutomata.html#2963" class="Generalizable">keys</a> <a id="3903" href="Prelude.Sets.AsUniqueLists.Core.html#2841" class="Function Operator">∪</a> <a id="3905" href="Prelude.Sets.AsUniqueLists.Core.html#2544" class="Function">singleton</a> <a id="3915" href="ContractAutomata.html#3022" class="Generalizable">key</a><a id="3918" class="Symbol">)</a> <a id="3920" class="Symbol">}</a>

  <a id="_⇒⟨_⟩_.Pay"></a><a id="3925" href="ContractAutomata.html#3925" class="InductiveConstructor">Pay</a> <a id="3929" class="Symbol">:</a> <a id="3931" class="Symbol">∀</a> <a id="3933" class="Symbol">(</a><a id="3934" href="ContractAutomata.html#3934" class="Bound">d&lt;</a> <a id="3937" class="Symbol">:</a> <a id="3939" href="ContractAutomata.html#2936" class="Generalizable">d</a> <a id="3941" class="Symbol">.</a><a id="3942" href="ContractAutomata.html#1941" class="Field">end</a> <a id="3946" href="Prelude.Ord.html#271" class="Field Operator">&lt;</a> <a id="3948" href="ContractAutomata.html#2938" class="Generalizable">d′</a> <a id="3951" class="Symbol">.</a><a id="3952" href="ContractAutomata.html#1941" class="Field">end</a><a id="3955" class="Symbol">)</a> <a id="3957" class="Symbol">→</a> <a id="3959" class="Keyword">let</a> <a id="3963" class="Keyword">instance</a> <a id="3972" href="ContractAutomata.html#3972" class="Bound">_</a> <a id="3974" class="Symbol">=</a> <a id="3976" href="ContractAutomata.html#3934" class="Bound">d&lt;</a> <a id="3979" class="Keyword">in</a>
    <a id="3986" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="3988" href="Prelude.Measurable.html#320" class="Field Operator">∣</a> <a id="3990" href="ContractAutomata.html#2963" class="Generalizable">keys</a> <a id="3995" href="Prelude.Measurable.html#320" class="Field Operator">∣</a> <a id="3997" href="Prelude.Ord.html#322" class="Function Operator">≥</a> <a id="3999" href="ContractAutomata.html#2626" class="Postulate">noRequiredSignatures</a>
    <a id="4024" href="Prelude.InferenceRules.html#56049" class="Function Operator">∙</a> <a id="4026" href="ContractAutomata.html#2938" class="Generalizable">d′</a> <a id="4029" class="Symbol">.</a><a id="4030" href="ContractAutomata.html#1941" class="Field">end</a> <a id="4034" href="Prelude.Ord.html#267" class="Field Operator">≤</a> <a id="4036" href="ContractAutomata.html#2993" class="Generalizable">payment</a> <a id="4044" class="Symbol">.</a><a id="4045" href="ContractAutomata.html#1059" class="Field">deadline</a>
      <a id="4060" href="Prelude.InferenceRules.html#12729" class="Function Operator">─────────────────────────────────────────────────────</a>
      <a id="4120" class="Keyword">record</a> <a id="4127" class="Symbol">{</a><a id="4128" href="ContractAutomata.html#4128" class="Module">defWith</a> <a id="4136" href="ContractAutomata.html#2921" class="Generalizable">v</a> <a id="4138" href="ContractAutomata.html#2936" class="Generalizable">d</a><a id="4139" class="Symbol">;</a> <a id="4141" href="ContractAutomata.html#2293" class="Field">state</a> <a id="4147" class="Symbol">=</a> <a id="4149" href="ContractAutomata.html#1340" class="InductiveConstructor">Collecting</a> <a id="4160" href="ContractAutomata.html#2993" class="Generalizable">payment</a> <a id="4168" href="ContractAutomata.html#2963" class="Generalizable">keys</a><a id="4172" class="Symbol">}</a>
      <a id="4180" href="ContractAutomata.html#3073" class="Datatype Operator">⇒⟨</a> <a id="4183" href="ContractAutomata.html#1575" class="InductiveConstructor">Pay</a> <a id="4187" href="ContractAutomata.html#3073" class="Datatype Operator">⟩</a>
      <a id="4195" class="Keyword">record</a> <a id="4202" class="Symbol">{</a> <a id="4204" href="ContractAutomata.html#4204" class="Module">defWith</a> <a id="4212" class="Symbol">(</a><a id="4213" href="ContractAutomata.html#2921" class="Generalizable">v</a> <a id="4215" href="Data.Nat.Base.html#2874" class="Primitive Operator">∸</a> <a id="4217" href="ContractAutomata.html#2993" class="Generalizable">payment</a> <a id="4225" class="Symbol">.</a><a id="4226" href="ContractAutomata.html#1009" class="Field">amount</a><a id="4232" class="Symbol">)</a> <a id="4234" href="ContractAutomata.html#2938" class="Generalizable">d′</a>
             <a id="4250" class="Symbol">;</a> <a id="4252" href="ContractAutomata.html#2293" class="Field">state</a> <a id="4258" class="Symbol">=</a> <a id="4260" href="ContractAutomata.html#1310" class="InductiveConstructor">Holding</a>
             <a id="4281" class="Symbol">;</a> <a id="4283" href="ContractAutomata.html#2365" class="Field">outputs</a> <a id="4291" class="Symbol">=</a> <a id="4293" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="4295" href="ContractAutomata.html#1795" class="Function">mkPayment</a> <a id="4305" href="ContractAutomata.html#2993" class="Generalizable">payment</a> <a id="4313" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="4315" class="Symbol">}</a>

  <a id="_⇒⟨_⟩_.Cancel"></a><a id="4320" href="ContractAutomata.html#4320" class="InductiveConstructor">Cancel</a> <a id="4327" class="Symbol">:</a> <a id="4329" class="Symbol">∀</a> <a id="4331" class="Symbol">(</a><a id="4332" href="ContractAutomata.html#4332" class="Bound">d&lt;</a> <a id="4335" class="Symbol">:</a> <a id="4337" href="ContractAutomata.html#2936" class="Generalizable">d</a> <a id="4339" class="Symbol">.</a><a id="4340" href="ContractAutomata.html#1941" class="Field">end</a> <a id="4344" href="Prelude.Ord.html#271" class="Field Operator">&lt;</a> <a id="4346" href="ContractAutomata.html#2938" class="Generalizable">d′</a> <a id="4349" class="Symbol">.</a><a id="4350" href="ContractAutomata.html#1941" class="Field">end</a><a id="4353" class="Symbol">)</a> <a id="4355" class="Symbol">→</a> <a id="4357" class="Keyword">let</a> <a id="4361" class="Keyword">instance</a> <a id="4370" href="ContractAutomata.html#4370" class="Bound">_</a> <a id="4372" class="Symbol">=</a> <a id="4374" href="ContractAutomata.html#4332" class="Bound">d&lt;</a> <a id="4377" class="Keyword">in</a>
    <a id="4384" href="ContractAutomata.html#2938" class="Generalizable">d′</a> <a id="4387" class="Symbol">.</a><a id="4388" href="ContractAutomata.html#1920" class="Field">start</a> <a id="4394" href="Prelude.Ord.html#339" class="Function Operator">&gt;</a> <a id="4396" href="ContractAutomata.html#2993" class="Generalizable">payment</a> <a id="4404" class="Symbol">.</a><a id="4405" href="ContractAutomata.html#1059" class="Field">deadline</a>
    <a id="4418" href="Prelude.InferenceRules.html#12729" class="Function Operator">─────────────────────────────────────────────────────</a>
    <a id="4476" class="Keyword">record</a> <a id="4483" class="Symbol">{</a><a id="4484" href="ContractAutomata.html#4484" class="Module">defWith</a> <a id="4492" href="ContractAutomata.html#2921" class="Generalizable">v</a> <a id="4494" href="ContractAutomata.html#2936" class="Generalizable">d</a><a id="4495" class="Symbol">;</a> <a id="4497" href="ContractAutomata.html#2293" class="Field">state</a> <a id="4503" class="Symbol">=</a> <a id="4505" href="ContractAutomata.html#1340" class="InductiveConstructor">Collecting</a> <a id="4516" href="ContractAutomata.html#2993" class="Generalizable">payment</a> <a id="4524" href="ContractAutomata.html#2963" class="Generalizable">keys</a><a id="4528" class="Symbol">}</a>
    <a id="4534" href="ContractAutomata.html#3073" class="Datatype Operator">⇒⟨</a> <a id="4537" href="ContractAutomata.html#1598" class="InductiveConstructor">Cancel</a> <a id="4544" href="ContractAutomata.html#3073" class="Datatype Operator">⟩</a>
    <a id="4550" class="Keyword">record</a> <a id="4557" class="Symbol">{</a><a id="4558" href="ContractAutomata.html#4558" class="Module">defWith</a> <a id="4566" href="ContractAutomata.html#2921" class="Generalizable">v</a> <a id="4568" href="ContractAutomata.html#2938" class="Generalizable">d′</a><a id="4570" class="Symbol">;</a> <a id="4572" href="ContractAutomata.html#2293" class="Field">state</a> <a id="4578" class="Symbol">=</a> <a id="4580" href="ContractAutomata.html#1310" class="InductiveConstructor">Holding</a><a id="4587" class="Symbol">}</a>

<a id="4590" class="Comment">-- ** Contract Implementation</a>

<a id="4621" class="Comment">-- transition : (s⁺ : Conf s) (l⁺ : l ⁺) → List Message → Time</a>
<a id="4684" class="Comment">--             → Maybe (∃ λ s′ → ∃ λ (s⁺′ : Conf s′) → (s⁺ ⇒⟨ l⁺ ⟩ s⁺′))</a>

<a id="transition"></a><a id="4758" href="ContractAutomata.html#4758" class="Function">transition</a> <a id="4769" class="Symbol">:</a> <a id="4771" href="ContractAutomata.html#2255" class="Record">Conf</a> <a id="4776" href="ContractAutomata.html#2891" class="Generalizable">s</a> <a id="4778" class="Symbol">→</a> <a id="4780" href="ContractAutomata.html#2906" class="Generalizable">l</a> <a id="4782" href="ContractAutomata.html#1239" class="Field Operator">⁺</a> <a id="4784" class="Symbol">→</a> <a id="4786" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4791" href="ContractAutomata.html#1768" class="Function">Message</a> <a id="4799" class="Symbol">→</a> <a id="4801" href="ContractAutomata.html#926" class="Function">Time</a>
           <a id="4817" class="Symbol">→</a> <a id="4819" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="4825" class="Symbol">(</a><a id="4826" href="Data.Product.html#1369" class="Function">∃</a> <a id="4828" class="Symbol">λ</a> <a id="4830" href="ContractAutomata.html#4830" class="Bound">s′</a> <a id="4833" class="Symbol">→</a> <a id="4835" class="Symbol">(</a><a id="4836" href="ContractAutomata.html#2891" class="Generalizable">s</a> <a id="4838" href="ContractAutomata.html#571" class="Datatype Operator">—[</a> <a id="4841" href="ContractAutomata.html#2906" class="Generalizable">l</a> <a id="4843" href="ContractAutomata.html#571" class="Datatype Operator">]→</a> <a id="4846" href="ContractAutomata.html#4830" class="Bound">s′</a><a id="4848" class="Symbol">)</a> <a id="4850" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4852" href="ContractAutomata.html#2255" class="Record">Conf</a> <a id="4857" href="ContractAutomata.html#4830" class="Bound">s′</a><a id="4859" class="Symbol">)</a>
<a id="4861" href="ContractAutomata.html#4758" class="Function">transition</a> <a id="4872" class="Symbol">{</a><a id="4873" href="ContractAutomata.html#358" class="InductiveConstructor">Holding</a><a id="4880" class="Symbol">}</a> <a id="4882" class="Symbol">{</a><a id="4883" href="ContractAutomata.html#473" class="InductiveConstructor">Propose</a><a id="4890" class="Symbol">}</a> <a id="4892" href="ContractAutomata.html#4892" class="Bound">s⁺</a> <a id="4895" class="Symbol">(</a><a id="4896" href="ContractAutomata.html#1505" class="InductiveConstructor">Propose</a> <a id="4904" href="ContractAutomata.html#4904" class="Bound">payment</a><a id="4911" class="Symbol">)</a> <a id="4913" href="ContractAutomata.html#4913" class="Bound">is</a> <a id="4916" href="ContractAutomata.html#4916" class="Bound">t</a> <a id="4918" class="Symbol">=</a>
  <a id="4922" class="Keyword">let</a> <a id="4926" href="ContractAutomata.html#4926" class="Bound">t′</a> <a id="4929" class="Symbol">=</a> <a id="4931" href="ContractAutomata.html#4916" class="Bound">t</a> <a id="4933" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="4935" href="ContractAutomata.html#2548" class="Postulate">standardInterval</a> <a id="4952" class="Keyword">in</a>
  <a id="4957" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="4960" class="Symbol">(</a><a id="4961" href="ContractAutomata.html#4892" class="Bound">s⁺</a> <a id="4964" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="4967" class="Keyword">record</a> <a id="4974" class="Symbol">{</a><a id="4975" href="ContractAutomata.html#4975" class="Module">defWith</a> <a id="4983" class="Symbol">(</a><a id="4984" href="ContractAutomata.html#4892" class="Bound">s⁺</a> <a id="4987" class="Symbol">.</a><a id="4988" href="ContractAutomata.html#2313" class="Field">value</a><a id="4993" class="Symbol">)</a> <a id="4995" class="Symbol">(</a><a id="4996" href="ContractAutomata.html#4892" class="Bound">s⁺</a> <a id="4999" class="Symbol">.</a><a id="5000" href="ContractAutomata.html#2396" class="Field">duration</a><a id="5008" class="Symbol">);</a> <a id="5011" href="ContractAutomata.html#2293" class="Field">state</a> <a id="5017" class="Symbol">=</a> <a id="5019" href="ContractAutomata.html#1310" class="InductiveConstructor">Holding</a><a id="5026" class="Symbol">})</a>
   <a id="5032" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="5034" class="Symbol">(</a><a id="5035" href="ContractAutomata.html#4913" class="Bound">is</a> <a id="5038" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="5041" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="5043" class="Symbol">)</a>
   <a id="5048" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="5050" class="Symbol">(</a><a id="5051" href="ContractAutomata.html#4892" class="Bound">s⁺</a> <a id="5054" class="Symbol">.</a><a id="5055" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="5064" class="Symbol">.</a><a id="5065" href="ContractAutomata.html#1941" class="Field">end</a> <a id="5069" href="Prelude.Ord.html#2548" class="Function Operator">&lt;ᵇ</a> <a id="5072" href="ContractAutomata.html#4926" class="Bound">t′</a><a id="5074" class="Symbol">)</a>
   <a id="5079" class="Comment">--</a>
   <a id="5085" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="5087" class="Symbol">(</a><a id="5088" class="Number">0</a> <a id="5090" href="Prelude.Ord.html#2548" class="Function Operator">&lt;ᵇ</a> <a id="5093" href="ContractAutomata.html#4904" class="Bound">payment</a> <a id="5101" class="Symbol">.</a><a id="5102" href="ContractAutomata.html#1009" class="Field">amount</a><a id="5108" class="Symbol">)</a>
   <a id="5113" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="5115" class="Symbol">(</a><a id="5116" href="ContractAutomata.html#4904" class="Bound">payment</a> <a id="5124" class="Symbol">.</a><a id="5125" href="ContractAutomata.html#1009" class="Field">amount</a> <a id="5132" href="Prelude.Ord.html#579" class="Function Operator">≤ᵇ</a> <a id="5135" href="ContractAutomata.html#4892" class="Bound">s⁺</a> <a id="5138" class="Symbol">.</a><a id="5139" href="ContractAutomata.html#2313" class="Field">value</a><a id="5144" class="Symbol">)</a>
   <a id="5149" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="5151" class="Symbol">(</a><a id="5152" href="ContractAutomata.html#4904" class="Bound">payment</a> <a id="5160" class="Symbol">.</a><a id="5161" href="ContractAutomata.html#1059" class="Field">deadline</a> <a id="5170" href="Prelude.Ord.html#2635" class="Function Operator">&gt;ᵇ</a> <a id="5173" href="ContractAutomata.html#4926" class="Bound">t′</a><a id="5175" class="Symbol">)</a>
  <a id="5179" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="5184" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5189" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5191" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="5194" href="Function.Base.html#4812" class="Function">it</a> <a id="5197" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5199" class="Keyword">record</a>
    <a id="5210" class="Symbol">{</a> <a id="5212" href="ContractAutomata.html#2054" class="Module">def</a>
    <a id="5220" class="Symbol">;</a> <a id="5222" href="ContractAutomata.html#2293" class="Field">state</a> <a id="5228" class="Symbol">=</a> <a id="5230" href="ContractAutomata.html#1340" class="InductiveConstructor">Collecting</a> <a id="5241" href="ContractAutomata.html#4904" class="Bound">payment</a> <a id="5249" href="Prelude.Sets.AsUniqueLists.Core.html#2531" class="InductiveConstructor">∅</a>
    <a id="5255" class="Symbol">;</a> <a id="5257" href="ContractAutomata.html#2313" class="Field">value</a> <a id="5263" class="Symbol">=</a> <a id="5265" href="ContractAutomata.html#4892" class="Bound">s⁺</a> <a id="5268" class="Symbol">.</a><a id="5269" href="ContractAutomata.html#2313" class="Field">value</a>
    <a id="5279" class="Symbol">;</a> <a id="5281" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="5290" class="Symbol">=</a> <a id="5292" href="ContractAutomata.html#4916" class="Bound">t</a> <a id="5294" href="ContractAutomata.html#1908" class="InductiveConstructor Operator">,</a> <a id="5296" href="ContractAutomata.html#4926" class="Bound">t′</a>
    <a id="5303" class="Symbol">}</a>
  <a id="5307" href="Data.Bool.Base.html#1283" class="Function Operator">else</a>
    <a id="5316" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="5324" href="ContractAutomata.html#4758" class="Function">transition</a> <a id="5335" class="Symbol">{</a><a id="5336" href="ContractAutomata.html#358" class="InductiveConstructor">Holding</a><a id="5343" class="Symbol">}</a> <a id="5345" class="Symbol">{</a><a id="5346" href="ContractAutomata.html#481" class="InductiveConstructor">Add</a><a id="5349" class="Symbol">}</a> <a id="5351" href="ContractAutomata.html#5351" class="Bound">s⁺</a> <a id="5354" href="ContractAutomata.html#5354" class="Bound">l⁺</a> <a id="5357" href="ContractAutomata.html#5357" class="Bound">is</a> <a id="5360" href="ContractAutomata.html#5360" class="Bound">t</a> <a id="5362" class="Symbol">=</a> <a id="5364" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="5372" class="Comment">-- no λ where (_ , ())</a>
<a id="5395" href="ContractAutomata.html#4758" class="Function">transition</a> <a id="5406" class="Symbol">{</a><a id="5407" href="ContractAutomata.html#358" class="InductiveConstructor">Holding</a><a id="5414" class="Symbol">}</a> <a id="5416" class="Symbol">{</a><a id="5417" href="ContractAutomata.html#485" class="InductiveConstructor">Pay</a><a id="5420" class="Symbol">}</a> <a id="5422" href="ContractAutomata.html#5422" class="Bound">s⁺</a> <a id="5425" href="ContractAutomata.html#5425" class="Bound">l⁺</a> <a id="5428" href="ContractAutomata.html#5428" class="Bound">is</a> <a id="5431" href="ContractAutomata.html#5431" class="Bound">t</a> <a id="5433" class="Symbol">=</a> <a id="5435" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="5443" href="ContractAutomata.html#4758" class="Function">transition</a> <a id="5454" class="Symbol">{</a><a id="5455" href="ContractAutomata.html#358" class="InductiveConstructor">Holding</a><a id="5462" class="Symbol">}</a> <a id="5464" class="Symbol">{</a><a id="5465" href="ContractAutomata.html#489" class="InductiveConstructor">Cancel</a><a id="5471" class="Symbol">}</a> <a id="5473" href="ContractAutomata.html#5473" class="Bound">s⁺</a> <a id="5476" href="ContractAutomata.html#5476" class="Bound">l⁺</a> <a id="5479" href="ContractAutomata.html#5479" class="Bound">is</a> <a id="5482" href="ContractAutomata.html#5482" class="Bound">t</a> <a id="5484" class="Symbol">=</a> <a id="5486" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="5494" href="ContractAutomata.html#4758" class="Function">transition</a> <a id="5505" class="Symbol">{</a><a id="5506" href="ContractAutomata.html#366" class="InductiveConstructor">Collecting</a><a id="5516" class="Symbol">}</a> <a id="5518" class="Symbol">{</a><a id="5519" href="ContractAutomata.html#473" class="InductiveConstructor">Propose</a><a id="5526" class="Symbol">}</a> <a id="5528" href="ContractAutomata.html#5528" class="Bound">s⁺</a> <a id="5531" href="ContractAutomata.html#5531" class="Bound">l⁺</a> <a id="5534" href="ContractAutomata.html#5534" class="Bound">is</a> <a id="5537" href="ContractAutomata.html#5537" class="Bound">t</a> <a id="5539" class="Symbol">=</a> <a id="5541" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="5549" href="ContractAutomata.html#4758" class="Function">transition</a> <a id="5560" class="Symbol">{</a><a id="5561" href="ContractAutomata.html#366" class="InductiveConstructor">Collecting</a><a id="5571" class="Symbol">}</a> <a id="5573" class="Symbol">{</a><a id="5574" href="ContractAutomata.html#481" class="InductiveConstructor">Add</a><a id="5577" class="Symbol">}</a> <a id="5579" href="ContractAutomata.html#5579" class="Bound">s⁺</a> <a id="5582" class="Symbol">(</a><a id="5583" href="ContractAutomata.html#1542" class="InductiveConstructor">Add</a> <a id="5587" href="ContractAutomata.html#5587" class="Bound">key</a><a id="5590" class="Symbol">)</a> <a id="5592" href="ContractAutomata.html#5592" class="Bound">is</a> <a id="5595" href="ContractAutomata.html#5595" class="Bound">t</a> <a id="5597" class="Symbol">=</a>
  <a id="5601" class="Keyword">let</a> <a id="5605" href="ContractAutomata.html#5605" class="Bound">t′</a> <a id="5608" class="Symbol">=</a> <a id="5610" href="ContractAutomata.html#5595" class="Bound">t</a> <a id="5612" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="5614" href="ContractAutomata.html#2548" class="Postulate">standardInterval</a> <a id="5631" class="Keyword">in</a>
  <a id="5636" class="Comment">-- with Collecting payment keys ← s⁺ .state =</a>
  <a id="5684" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="5689" href="ContractAutomata.html#5579" class="Bound">s⁺</a> <a id="5692" class="Symbol">.</a><a id="5693" href="ContractAutomata.html#2293" class="Field">state</a> <a id="5699" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="5702" class="Symbol">λ</a> <a id="5704" class="Keyword">where</a>
    <a id="5714" class="Symbol">(</a><a id="5715" href="ContractAutomata.html#1340" class="InductiveConstructor">Collecting</a> <a id="5726" href="ContractAutomata.html#5726" class="Bound">payment</a> <a id="5734" href="ContractAutomata.html#5734" class="Bound">keys</a><a id="5738" class="Symbol">)</a> <a id="5740" class="Symbol">→</a>
      <a id="5748" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="5751" class="Symbol">(</a><a id="5752" href="ContractAutomata.html#5592" class="Bound">is</a> <a id="5755" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="5758" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="5760" class="Symbol">)</a>
       <a id="5769" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="5771" class="Symbol">(</a><a id="5772" href="ContractAutomata.html#5579" class="Bound">s⁺</a> <a id="5775" class="Symbol">.</a><a id="5776" href="ContractAutomata.html#2335" class="Field">inputs</a> <a id="5783" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="5786" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="5788" class="Symbol">)</a>
       <a id="5797" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="5799" class="Symbol">(</a><a id="5800" href="ContractAutomata.html#5579" class="Bound">s⁺</a> <a id="5803" class="Symbol">.</a><a id="5804" href="ContractAutomata.html#2365" class="Field">outputs</a> <a id="5812" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="5815" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="5817" class="Symbol">)</a>
       <a id="5826" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="5828" class="Symbol">(</a><a id="5829" href="ContractAutomata.html#5579" class="Bound">s⁺</a> <a id="5832" class="Symbol">.</a><a id="5833" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="5842" class="Symbol">.</a><a id="5843" href="ContractAutomata.html#1941" class="Field">end</a> <a id="5847" href="Prelude.Ord.html#2548" class="Function Operator">&lt;ᵇ</a> <a id="5850" href="ContractAutomata.html#5605" class="Bound">t′</a><a id="5852" class="Symbol">)</a>
       <a id="5861" class="Comment">--</a>
       <a id="5871" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="5873" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="5875" href="ContractAutomata.html#5587" class="Bound">key</a> <a id="5879" href="Prelude.Sets.AsUniqueLists.Core.html#2342" class="Function Operator">∈ˢ?</a> <a id="5883" href="ContractAutomata.html#2592" class="Postulate">authorizedKeys</a> <a id="5898" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a>
      <a id="5906" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="5911" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5916" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5918" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="5921" href="Function.Base.html#4812" class="Function">it</a> <a id="5924" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5926" class="Keyword">record</a>
        <a id="5941" class="Symbol">{</a> <a id="5943" href="ContractAutomata.html#2054" class="Module">def</a>
        <a id="5955" class="Symbol">;</a> <a id="5957" href="ContractAutomata.html#2293" class="Field">state</a> <a id="5963" class="Symbol">=</a> <a id="5965" href="ContractAutomata.html#1340" class="InductiveConstructor">Collecting</a> <a id="5976" href="ContractAutomata.html#5726" class="Bound">payment</a> <a id="5984" class="Symbol">(</a><a id="5985" href="ContractAutomata.html#5734" class="Bound">keys</a> <a id="5990" href="Prelude.Sets.AsUniqueLists.Core.html#2841" class="Function Operator">∪</a> <a id="5992" href="Prelude.Sets.AsUniqueLists.Core.html#2544" class="Function">singleton</a> <a id="6002" href="ContractAutomata.html#5587" class="Bound">key</a><a id="6005" class="Symbol">)</a>
        <a id="6015" class="Symbol">;</a> <a id="6017" href="ContractAutomata.html#2313" class="Field">value</a> <a id="6023" class="Symbol">=</a> <a id="6025" href="ContractAutomata.html#5579" class="Bound">s⁺</a> <a id="6028" class="Symbol">.</a><a id="6029" href="ContractAutomata.html#2313" class="Field">value</a>
        <a id="6043" class="Symbol">;</a> <a id="6045" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="6054" class="Symbol">=</a> <a id="6056" href="ContractAutomata.html#5595" class="Bound">t</a> <a id="6058" href="ContractAutomata.html#1908" class="InductiveConstructor Operator">,</a> <a id="6060" href="ContractAutomata.html#5605" class="Bound">t′</a>
        <a id="6071" class="Symbol">;</a> <a id="6073" href="ContractAutomata.html#2424" class="Field">signers</a> <a id="6081" class="Symbol">=</a> <a id="6083" href="Prelude.Sets.AsUniqueLists.Core.html#2544" class="Function">singleton</a> <a id="6093" href="ContractAutomata.html#5587" class="Bound">key</a>
        <a id="6105" class="Symbol">}</a>
      <a id="6113" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="6118" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="6126" href="ContractAutomata.html#4758" class="Function">transition</a> <a id="6137" class="Symbol">{</a><a id="6138" href="ContractAutomata.html#366" class="InductiveConstructor">Collecting</a><a id="6148" class="Symbol">}</a> <a id="6150" class="Symbol">{</a><a id="6151" href="ContractAutomata.html#485" class="InductiveConstructor">Pay</a><a id="6154" class="Symbol">}</a> <a id="6156" href="ContractAutomata.html#6156" class="Bound">s⁺</a> <a id="6159" href="ContractAutomata.html#6159" class="Bound">l⁺</a> <a id="6162" href="ContractAutomata.html#6162" class="Bound">is</a> <a id="6165" href="ContractAutomata.html#6165" class="Bound">t</a> <a id="6167" class="Symbol">=</a>
  <a id="6171" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="6176" href="ContractAutomata.html#6156" class="Bound">s⁺</a> <a id="6179" class="Symbol">.</a><a id="6180" href="ContractAutomata.html#2293" class="Field">state</a> <a id="6186" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="6189" class="Symbol">λ</a> <a id="6191" class="Keyword">where</a>
    <a id="6201" class="Symbol">(</a><a id="6202" href="ContractAutomata.html#1340" class="InductiveConstructor">Collecting</a> <a id="6213" href="ContractAutomata.html#6213" class="Bound">payment</a> <a id="6221" href="ContractAutomata.html#6221" class="Bound">keys</a><a id="6225" class="Symbol">)</a> <a id="6227" class="Symbol">→</a>
      <a id="6235" class="Keyword">let</a> <a id="6239" href="ContractAutomata.html#6239" class="Bound">t′</a> <a id="6242" class="Symbol">=</a> <a id="6244" class="Symbol">(</a><a id="6245" href="ContractAutomata.html#6165" class="Bound">t</a> <a id="6247" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="6249" href="ContractAutomata.html#2548" class="Postulate">standardInterval</a><a id="6265" class="Symbol">)</a> <a id="6267" href="Data.Nat.Base.html#3157" class="Function Operator">⊓</a> <a id="6269" href="ContractAutomata.html#6213" class="Bound">payment</a> <a id="6277" class="Symbol">.</a><a id="6278" href="ContractAutomata.html#1059" class="Field">deadline</a> <a id="6287" class="Keyword">in</a>
      <a id="6296" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="6299" class="Symbol">(</a><a id="6300" href="ContractAutomata.html#6162" class="Bound">is</a> <a id="6303" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="6306" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6308" class="Symbol">)</a>
       <a id="6317" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="6319" class="Symbol">(</a><a id="6320" href="ContractAutomata.html#6156" class="Bound">s⁺</a> <a id="6323" class="Symbol">.</a><a id="6324" href="ContractAutomata.html#2335" class="Field">inputs</a> <a id="6331" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="6334" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6336" class="Symbol">)</a>
       <a id="6345" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="6347" class="Symbol">(</a><a id="6348" href="ContractAutomata.html#6156" class="Bound">s⁺</a> <a id="6351" class="Symbol">.</a><a id="6352" href="ContractAutomata.html#2365" class="Field">outputs</a> <a id="6360" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="6363" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6365" class="Symbol">)</a>
       <a id="6374" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="6376" class="Symbol">(</a><a id="6377" href="ContractAutomata.html#6156" class="Bound">s⁺</a> <a id="6380" class="Symbol">.</a><a id="6381" href="ContractAutomata.html#2424" class="Field">signers</a> <a id="6389" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="6392" href="Prelude.Sets.AsUniqueLists.Core.html#2531" class="InductiveConstructor">∅</a><a id="6393" class="Symbol">)</a>
       <a id="6402" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="6404" class="Symbol">(</a><a id="6405" href="ContractAutomata.html#6156" class="Bound">s⁺</a> <a id="6408" class="Symbol">.</a><a id="6409" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="6418" class="Symbol">.</a><a id="6419" href="ContractAutomata.html#1941" class="Field">end</a> <a id="6423" href="Prelude.Ord.html#2548" class="Function Operator">&lt;ᵇ</a> <a id="6426" href="ContractAutomata.html#6239" class="Bound">t′</a><a id="6428" class="Symbol">)</a>
       <a id="6437" class="Comment">--</a>
       <a id="6447" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="6449" class="Symbol">(</a><a id="6450" href="Prelude.Measurable.html#320" class="Field Operator">∣</a> <a id="6452" href="ContractAutomata.html#6221" class="Bound">keys</a> <a id="6457" href="Prelude.Measurable.html#320" class="Field Operator">∣</a> <a id="6459" href="Prelude.Ord.html#666" class="Function Operator">≥ᵇ</a> <a id="6462" href="ContractAutomata.html#2626" class="Postulate">noRequiredSignatures</a><a id="6482" class="Symbol">)</a>
       <a id="6491" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="6493" class="Symbol">(</a><a id="6494" href="ContractAutomata.html#6165" class="Bound">t</a> <a id="6496" href="Prelude.Ord.html#2548" class="Function Operator">&lt;ᵇ</a> <a id="6499" href="ContractAutomata.html#6213" class="Bound">payment</a> <a id="6507" class="Symbol">.</a><a id="6508" href="ContractAutomata.html#1059" class="Field">deadline</a><a id="6516" class="Symbol">)</a>
      <a id="6524" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="6529" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="6534" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="6536" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="6539" href="Function.Base.html#4812" class="Function">it</a> <a id="6542" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6544" class="Keyword">record</a>
        <a id="6559" class="Symbol">{</a> <a id="6561" href="ContractAutomata.html#2054" class="Module">def</a>
        <a id="6573" class="Symbol">;</a> <a id="6575" href="ContractAutomata.html#2293" class="Field">state</a> <a id="6581" class="Symbol">=</a> <a id="6583" href="ContractAutomata.html#1310" class="InductiveConstructor">Holding</a>
        <a id="6599" class="Symbol">;</a> <a id="6601" href="ContractAutomata.html#2313" class="Field">value</a> <a id="6607" class="Symbol">=</a> <a id="6609" href="ContractAutomata.html#6156" class="Bound">s⁺</a> <a id="6612" class="Symbol">.</a><a id="6613" href="ContractAutomata.html#2313" class="Field">value</a> <a id="6619" href="Data.Nat.Base.html#2874" class="Primitive Operator">∸</a> <a id="6621" href="ContractAutomata.html#6213" class="Bound">payment</a> <a id="6629" class="Symbol">.</a><a id="6630" href="ContractAutomata.html#1009" class="Field">amount</a>
        <a id="6645" class="Symbol">;</a> <a id="6647" href="ContractAutomata.html#2365" class="Field">outputs</a> <a id="6655" class="Symbol">=</a> <a id="6657" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="6659" href="ContractAutomata.html#1795" class="Function">mkPayment</a> <a id="6669" href="ContractAutomata.html#6213" class="Bound">payment</a> <a id="6677" href="Data.List.Base.html#5025" class="Function Operator">]</a>
        <a id="6687" class="Symbol">;</a> <a id="6689" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="6698" class="Symbol">=</a> <a id="6700" href="ContractAutomata.html#6165" class="Bound">t</a> <a id="6702" href="ContractAutomata.html#1908" class="InductiveConstructor Operator">,</a> <a id="6704" href="ContractAutomata.html#6239" class="Bound">t′</a>
        <a id="6715" class="Symbol">}</a>
      <a id="6723" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="6728" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="6736" href="ContractAutomata.html#4758" class="Function">transition</a> <a id="6747" class="Symbol">{</a><a id="6748" href="ContractAutomata.html#366" class="InductiveConstructor">Collecting</a><a id="6758" class="Symbol">}</a> <a id="6760" class="Symbol">{</a><a id="6761" href="ContractAutomata.html#489" class="InductiveConstructor">Cancel</a><a id="6767" class="Symbol">}</a> <a id="6769" href="ContractAutomata.html#6769" class="Bound">s⁺</a> <a id="6772" href="ContractAutomata.html#6772" class="Bound">l⁺</a> <a id="6775" href="ContractAutomata.html#6775" class="Bound">is</a> <a id="6778" href="ContractAutomata.html#6778" class="Bound">t</a> <a id="6780" class="Symbol">=</a>
  <a id="6784" class="Keyword">let</a> <a id="6788" href="ContractAutomata.html#6788" class="Bound">t′</a> <a id="6791" class="Symbol">=</a> <a id="6793" href="ContractAutomata.html#6778" class="Bound">t</a> <a id="6795" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="6797" href="ContractAutomata.html#2548" class="Postulate">standardInterval</a> <a id="6814" class="Keyword">in</a>
  <a id="6819" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="6824" href="ContractAutomata.html#6769" class="Bound">s⁺</a> <a id="6827" class="Symbol">.</a><a id="6828" href="ContractAutomata.html#2293" class="Field">state</a> <a id="6834" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="6837" class="Symbol">λ</a> <a id="6839" class="Keyword">where</a>
    <a id="6849" class="Symbol">(</a><a id="6850" href="ContractAutomata.html#1340" class="InductiveConstructor">Collecting</a> <a id="6861" href="ContractAutomata.html#6861" class="Bound">payment</a> <a id="6869" href="ContractAutomata.html#6869" class="Bound">keys</a><a id="6873" class="Symbol">)</a> <a id="6875" class="Symbol">→</a>
      <a id="6883" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="6886" class="Symbol">(</a><a id="6887" href="ContractAutomata.html#6775" class="Bound">is</a> <a id="6890" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="6893" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6895" class="Symbol">)</a>
       <a id="6904" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="6906" class="Symbol">(</a><a id="6907" href="ContractAutomata.html#6769" class="Bound">s⁺</a> <a id="6910" class="Symbol">.</a><a id="6911" href="ContractAutomata.html#2335" class="Field">inputs</a> <a id="6918" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="6921" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6923" class="Symbol">)</a>
       <a id="6932" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="6934" class="Symbol">(</a><a id="6935" href="ContractAutomata.html#6769" class="Bound">s⁺</a> <a id="6938" class="Symbol">.</a><a id="6939" href="ContractAutomata.html#2365" class="Field">outputs</a> <a id="6947" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="6950" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6952" class="Symbol">)</a>
       <a id="6961" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="6963" class="Symbol">(</a><a id="6964" href="ContractAutomata.html#6769" class="Bound">s⁺</a> <a id="6967" class="Symbol">.</a><a id="6968" href="ContractAutomata.html#2424" class="Field">signers</a> <a id="6976" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="6979" href="Prelude.Sets.AsUniqueLists.Core.html#2531" class="InductiveConstructor">∅</a><a id="6980" class="Symbol">)</a>
       <a id="6989" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="6991" class="Symbol">(</a><a id="6992" href="ContractAutomata.html#6769" class="Bound">s⁺</a> <a id="6995" class="Symbol">.</a><a id="6996" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="7005" class="Symbol">.</a><a id="7006" href="ContractAutomata.html#1941" class="Field">end</a> <a id="7010" href="Prelude.Ord.html#2548" class="Function Operator">&lt;ᵇ</a> <a id="7013" href="ContractAutomata.html#6788" class="Bound">t′</a><a id="7015" class="Symbol">)</a>
       <a id="7024" class="Comment">--</a>
       <a id="7034" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="7036" class="Symbol">(</a><a id="7037" href="ContractAutomata.html#6778" class="Bound">t</a> <a id="7039" href="Prelude.Ord.html#2635" class="Function Operator">&gt;ᵇ</a> <a id="7042" href="ContractAutomata.html#6861" class="Bound">payment</a> <a id="7050" class="Symbol">.</a><a id="7051" href="ContractAutomata.html#1059" class="Field">deadline</a><a id="7059" class="Symbol">)</a>
      <a id="7067" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="7072" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="7077" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7079" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="7082" href="Function.Base.html#4812" class="Function">it</a> <a id="7085" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7087" class="Keyword">record</a>
        <a id="7102" class="Symbol">{</a> <a id="7104" href="ContractAutomata.html#2054" class="Module">def</a>
        <a id="7116" class="Symbol">;</a> <a id="7118" href="ContractAutomata.html#2293" class="Field">state</a> <a id="7124" class="Symbol">=</a> <a id="7126" href="ContractAutomata.html#1310" class="InductiveConstructor">Holding</a>
        <a id="7142" class="Symbol">;</a> <a id="7144" href="ContractAutomata.html#2313" class="Field">value</a> <a id="7150" class="Symbol">=</a> <a id="7152" href="ContractAutomata.html#6769" class="Bound">s⁺</a> <a id="7155" class="Symbol">.</a><a id="7156" href="ContractAutomata.html#2313" class="Field">value</a>
        <a id="7170" class="Symbol">;</a> <a id="7172" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="7181" class="Symbol">=</a> <a id="7183" href="ContractAutomata.html#6778" class="Bound">t</a> <a id="7185" href="ContractAutomata.html#1908" class="InductiveConstructor Operator">,</a> <a id="7187" href="ContractAutomata.html#6788" class="Bound">t′</a>
        <a id="7198" class="Symbol">}</a>
      <a id="7206" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="7211" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

<a id="validate"></a><a id="7220" href="ContractAutomata.html#7220" class="Function">validate</a> <a id="7229" class="Symbol">:</a> <a id="7231" href="ContractAutomata.html#2891" class="Generalizable">s</a> <a id="7233" href="ContractAutomata.html#1239" class="Field Operator">⁺</a> <a id="7235" class="Symbol">→</a> <a id="7237" href="ContractAutomata.html#2906" class="Generalizable">l</a> <a id="7239" href="ContractAutomata.html#1239" class="Field Operator">⁺</a> <a id="7241" class="Symbol">→</a> <a id="7243" href="ContractAutomata.html#2255" class="Record">Conf</a> <a id="7248" href="ContractAutomata.html#2893" class="Generalizable">s′</a> <a id="7251" class="Symbol">→</a> <a id="7253" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="7258" href="ContractAutomata.html#7220" class="Function">validate</a> <a id="7267" class="Symbol">{</a><a id="7268" href="ContractAutomata.html#358" class="InductiveConstructor">Holding</a><a id="7275" class="Symbol">}</a> <a id="7277" class="Symbol">{</a><a id="7278" href="ContractAutomata.html#473" class="InductiveConstructor">Propose</a><a id="7285" class="Symbol">}</a> <a id="7287" href="ContractAutomata.html#1310" class="InductiveConstructor">Holding</a> <a id="7295" class="Symbol">(</a><a id="7296" href="ContractAutomata.html#1505" class="InductiveConstructor">Propose</a> <a id="7304" href="ContractAutomata.html#7304" class="Bound">payment</a><a id="7311" class="Symbol">)</a> <a id="7313" href="ContractAutomata.html#7313" class="Bound">s⁺′</a> <a id="7317" class="Symbol">=</a>
  <a id="7321" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="7326" href="ContractAutomata.html#7313" class="Bound">s⁺′</a> <a id="7330" class="Symbol">.</a><a id="7331" href="ContractAutomata.html#2293" class="Field">state</a> <a id="7337" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="7340" class="Symbol">λ</a> <a id="7342" class="Keyword">where</a>
    <a id="7352" class="Symbol">(</a><a id="7353" href="ContractAutomata.html#1340" class="InductiveConstructor">Collecting</a> <a id="7364" href="ContractAutomata.html#7364" class="Bound">payment</a> <a id="7372" href="ContractAutomata.html#7372" class="Bound">keys</a><a id="7376" class="Symbol">)</a> <a id="7378" class="Symbol">→</a>
        <a id="7388" class="Symbol">(</a><a id="7389" href="ContractAutomata.html#7313" class="Bound">s⁺′</a> <a id="7393" class="Symbol">.</a><a id="7394" href="ContractAutomata.html#2365" class="Field">outputs</a> <a id="7402" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="7405" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7407" class="Symbol">)</a>
      <a id="7415" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="7417" class="Symbol">(</a><a id="7418" class="Number">0</a> <a id="7420" href="Prelude.Ord.html#2548" class="Function Operator">&lt;ᵇ</a> <a id="7423" href="ContractAutomata.html#7364" class="Bound">payment</a> <a id="7431" class="Symbol">.</a><a id="7432" href="ContractAutomata.html#1009" class="Field">amount</a><a id="7438" class="Symbol">)</a>
      <a id="7446" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="7448" class="Symbol">(</a><a id="7449" href="ContractAutomata.html#7364" class="Bound">payment</a> <a id="7457" class="Symbol">.</a><a id="7458" href="ContractAutomata.html#1009" class="Field">amount</a> <a id="7465" href="Prelude.Ord.html#579" class="Function Operator">≤ᵇ</a> <a id="7468" href="ContractAutomata.html#7313" class="Bound">s⁺′</a> <a id="7472" class="Symbol">.</a><a id="7473" href="ContractAutomata.html#2313" class="Field">value</a><a id="7478" class="Symbol">)</a>
      <a id="7486" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="7488" class="Symbol">(</a><a id="7489" href="ContractAutomata.html#7364" class="Bound">payment</a> <a id="7497" class="Symbol">.</a><a id="7498" href="ContractAutomata.html#1059" class="Field">deadline</a> <a id="7507" href="Prelude.Ord.html#2635" class="Function Operator">&gt;ᵇ</a> <a id="7510" href="ContractAutomata.html#7313" class="Bound">s⁺′</a> <a id="7514" class="Symbol">.</a><a id="7515" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="7524" class="Symbol">.</a><a id="7525" href="ContractAutomata.html#1941" class="Field">end</a><a id="7528" class="Symbol">)</a>
      <a id="7536" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="7538" href="Prelude.Null.html#339" class="Function">Nullᵇ</a> <a id="7544" href="ContractAutomata.html#7372" class="Bound">keys</a>
    <a id="7553" class="CatchallClause Symbol">_</a> <a id="7555" class="Symbol">→</a> <a id="7557" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="7563" href="ContractAutomata.html#7220" class="Function">validate</a> <a id="7572" class="Symbol">{</a><a id="7573" href="ContractAutomata.html#358" class="InductiveConstructor">Holding</a><a id="7580" class="Symbol">}</a> <a id="7582" class="Symbol">{</a><a id="7583" href="ContractAutomata.html#481" class="InductiveConstructor">Add</a><a id="7586" class="Symbol">}</a> <a id="7588" href="ContractAutomata.html#7588" class="Bound">s⁺</a> <a id="7591" href="ContractAutomata.html#7591" class="Bound">l⁺</a> <a id="7594" href="ContractAutomata.html#7594" class="Bound">s⁺′</a> <a id="7598" class="Symbol">=</a> <a id="7600" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="7606" href="ContractAutomata.html#7220" class="Function">validate</a> <a id="7615" class="Symbol">{</a><a id="7616" href="ContractAutomata.html#358" class="InductiveConstructor">Holding</a><a id="7623" class="Symbol">}</a> <a id="7625" class="Symbol">{</a><a id="7626" href="ContractAutomata.html#485" class="InductiveConstructor">Pay</a><a id="7629" class="Symbol">}</a> <a id="7631" href="ContractAutomata.html#7631" class="Bound">s⁺</a> <a id="7634" href="ContractAutomata.html#7634" class="Bound">l⁺</a> <a id="7637" href="ContractAutomata.html#7637" class="Bound">s⁺′</a> <a id="7641" class="Symbol">=</a> <a id="7643" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="7649" href="ContractAutomata.html#7220" class="Function">validate</a> <a id="7658" class="Symbol">{</a><a id="7659" href="ContractAutomata.html#358" class="InductiveConstructor">Holding</a><a id="7666" class="Symbol">}</a> <a id="7668" class="Symbol">{</a><a id="7669" href="ContractAutomata.html#489" class="InductiveConstructor">Cancel</a><a id="7675" class="Symbol">}</a> <a id="7677" href="ContractAutomata.html#7677" class="Bound">s⁺</a> <a id="7680" href="ContractAutomata.html#7680" class="Bound">l⁺</a> <a id="7683" href="ContractAutomata.html#7683" class="Bound">s⁺′</a> <a id="7687" class="Symbol">=</a> <a id="7689" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="7695" href="ContractAutomata.html#7220" class="Function">validate</a> <a id="7704" class="Symbol">{</a><a id="7705" href="ContractAutomata.html#366" class="InductiveConstructor">Collecting</a><a id="7715" class="Symbol">}</a> <a id="7717" class="Symbol">{</a><a id="7718" href="ContractAutomata.html#473" class="InductiveConstructor">Propose</a><a id="7725" class="Symbol">}</a> <a id="7727" href="ContractAutomata.html#7727" class="Bound">s⁺</a> <a id="7730" href="ContractAutomata.html#7730" class="Bound">l⁺</a> <a id="7733" href="ContractAutomata.html#7733" class="Bound">s⁺′</a> <a id="7737" class="Symbol">=</a> <a id="7739" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="7745" href="ContractAutomata.html#7220" class="Function">validate</a> <a id="7754" class="Symbol">{</a><a id="7755" href="ContractAutomata.html#366" class="InductiveConstructor">Collecting</a><a id="7765" class="Symbol">}</a> <a id="7767" class="Symbol">{</a><a id="7768" href="ContractAutomata.html#481" class="InductiveConstructor">Add</a><a id="7771" class="Symbol">}</a> <a id="7773" href="ContractAutomata.html#7773" class="Bound">s⁺</a> <a id="7776" class="Symbol">(</a><a id="7777" href="ContractAutomata.html#1542" class="InductiveConstructor">Add</a> <a id="7781" href="ContractAutomata.html#7781" class="Bound">key</a><a id="7784" class="Symbol">)</a> <a id="7786" href="ContractAutomata.html#7786" class="Bound">s⁺′</a> <a id="7790" class="Symbol">=</a>
  <a id="7794" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="7799" href="ContractAutomata.html#7786" class="Bound">s⁺′</a> <a id="7803" class="Symbol">.</a><a id="7804" href="ContractAutomata.html#2293" class="Field">state</a> <a id="7810" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="7813" class="Symbol">λ</a> <a id="7815" class="Keyword">where</a>
    <a id="7825" class="Symbol">(</a><a id="7826" href="ContractAutomata.html#1340" class="InductiveConstructor">Collecting</a> <a id="7837" href="ContractAutomata.html#7837" class="Bound">payment</a> <a id="7845" href="ContractAutomata.html#7845" class="Bound">keys</a><a id="7849" class="Symbol">)</a> <a id="7851" class="Symbol">→</a>
        <a id="7861" class="Symbol">(</a><a id="7862" href="ContractAutomata.html#7786" class="Bound">s⁺′</a> <a id="7866" class="Symbol">.</a><a id="7867" href="ContractAutomata.html#2365" class="Field">outputs</a> <a id="7875" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="7878" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7880" class="Symbol">)</a>
      <a id="7888" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="7890" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="7892" href="ContractAutomata.html#7781" class="Bound">key</a> <a id="7896" href="Prelude.Sets.AsUniqueLists.Core.html#2342" class="Function Operator">∈ˢ?</a> <a id="7900" href="ContractAutomata.html#7786" class="Bound">s⁺′</a> <a id="7904" class="Symbol">.</a><a id="7905" href="ContractAutomata.html#2424" class="Field">signers</a> <a id="7913" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a>
      <a id="7921" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="7923" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="7925" href="ContractAutomata.html#7781" class="Bound">key</a> <a id="7929" href="Prelude.Sets.AsUniqueLists.Core.html#2342" class="Function Operator">∈ˢ?</a> <a id="7933" href="ContractAutomata.html#2592" class="Postulate">authorizedKeys</a> <a id="7948" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a>
      <a id="7956" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="7958" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="7960" href="ContractAutomata.html#7781" class="Bound">key</a> <a id="7964" href="Prelude.Sets.AsUniqueLists.Core.html#2342" class="Function Operator">∈ˢ?</a> <a id="7968" href="ContractAutomata.html#7845" class="Bound">keys</a> <a id="7973" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a>
    <a id="7979" class="CatchallClause Symbol">_</a> <a id="7981" class="Symbol">→</a> <a id="7983" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="7989" href="ContractAutomata.html#7220" class="Function">validate</a> <a id="7998" class="Symbol">{</a><a id="7999" href="ContractAutomata.html#366" class="InductiveConstructor">Collecting</a><a id="8009" class="Symbol">}</a> <a id="8011" class="Symbol">{</a><a id="8012" href="ContractAutomata.html#485" class="InductiveConstructor">Pay</a><a id="8015" class="Symbol">}</a> <a id="8017" class="Symbol">(</a><a id="8018" href="ContractAutomata.html#1340" class="InductiveConstructor">Collecting</a> <a id="8029" href="ContractAutomata.html#8029" class="Bound">payment</a> <a id="8037" href="ContractAutomata.html#8037" class="Bound">keys</a><a id="8041" class="Symbol">)</a> <a id="8043" href="ContractAutomata.html#8043" class="Bound">l⁺</a> <a id="8046" href="ContractAutomata.html#8046" class="Bound">s⁺′</a> <a id="8050" class="Symbol">=</a>
  <a id="8054" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="8059" href="ContractAutomata.html#8046" class="Bound">s⁺′</a> <a id="8063" class="Symbol">.</a><a id="8064" href="ContractAutomata.html#2293" class="Field">state</a> <a id="8070" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="8073" class="Symbol">λ</a> <a id="8075" class="Keyword">where</a>
    <a id="8085" href="ContractAutomata.html#1310" class="InductiveConstructor">Holding</a> <a id="8093" class="Symbol">→</a>
        <a id="8103" class="Symbol">(</a><a id="8104" href="Prelude.Measurable.html#320" class="Field Operator">∣</a> <a id="8106" href="ContractAutomata.html#8037" class="Bound">keys</a> <a id="8111" href="Prelude.Measurable.html#320" class="Field Operator">∣</a> <a id="8113" href="Prelude.Ord.html#666" class="Function Operator">≥ᵇ</a> <a id="8116" href="ContractAutomata.html#2626" class="Postulate">noRequiredSignatures</a><a id="8136" class="Symbol">)</a>
      <a id="8144" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="8146" class="Symbol">(</a><a id="8147" href="ContractAutomata.html#8046" class="Bound">s⁺′</a> <a id="8151" class="Symbol">.</a><a id="8152" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="8161" class="Symbol">.</a><a id="8162" href="ContractAutomata.html#1941" class="Field">end</a> <a id="8166" href="Prelude.Ord.html#579" class="Function Operator">≤ᵇ</a> <a id="8169" href="ContractAutomata.html#8029" class="Bound">payment</a> <a id="8177" class="Symbol">.</a><a id="8178" href="ContractAutomata.html#1059" class="Field">deadline</a><a id="8186" class="Symbol">)</a>
      <a id="8194" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="8196" class="Symbol">(</a><a id="8197" href="Data.List.Base.html#7307" class="Function">take</a> <a id="8202" class="Number">1</a> <a id="8204" class="Symbol">(</a><a id="8205" href="ContractAutomata.html#8046" class="Bound">s⁺′</a> <a id="8209" class="Symbol">.</a><a id="8210" href="ContractAutomata.html#2365" class="Field">outputs</a><a id="8217" class="Symbol">)</a> <a id="8219" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="8222" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="8224" href="ContractAutomata.html#1795" class="Function">mkPayment</a> <a id="8234" href="ContractAutomata.html#8029" class="Bound">payment</a> <a id="8242" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="8243" class="Symbol">)</a>
    <a id="8249" class="CatchallClause Symbol">_</a> <a id="8251" class="Symbol">→</a> <a id="8253" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="8259" href="ContractAutomata.html#7220" class="Function">validate</a> <a id="8268" class="Symbol">{</a><a id="8269" href="ContractAutomata.html#366" class="InductiveConstructor">Collecting</a><a id="8279" class="Symbol">}</a> <a id="8281" class="Symbol">{</a><a id="8282" href="ContractAutomata.html#489" class="InductiveConstructor">Cancel</a><a id="8288" class="Symbol">}</a> <a id="8290" class="Symbol">(</a><a id="8291" href="ContractAutomata.html#1340" class="InductiveConstructor">Collecting</a> <a id="8302" href="ContractAutomata.html#8302" class="Bound">payment</a> <a id="8310" href="ContractAutomata.html#8310" class="Bound">keys</a><a id="8314" class="Symbol">)</a> <a id="8316" href="ContractAutomata.html#8316" class="Bound">l⁺</a> <a id="8319" href="ContractAutomata.html#8319" class="Bound">s⁺′</a> <a id="8323" class="Symbol">=</a>
  <a id="8327" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="8332" href="ContractAutomata.html#8319" class="Bound">s⁺′</a> <a id="8336" class="Symbol">.</a><a id="8337" href="ContractAutomata.html#2293" class="Field">state</a> <a id="8343" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="8346" class="Symbol">λ</a> <a id="8348" class="Keyword">where</a>
    <a id="8358" href="ContractAutomata.html#1310" class="InductiveConstructor">Holding</a> <a id="8366" class="Symbol">→</a>
        <a id="8376" class="Symbol">(</a><a id="8377" href="ContractAutomata.html#8319" class="Bound">s⁺′</a> <a id="8381" class="Symbol">.</a><a id="8382" href="ContractAutomata.html#2365" class="Field">outputs</a> <a id="8390" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="8393" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8395" class="Symbol">)</a>
      <a id="8403" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="8405" class="Symbol">(</a><a id="8406" href="ContractAutomata.html#8319" class="Bound">s⁺′</a> <a id="8410" class="Symbol">.</a><a id="8411" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="8420" class="Symbol">.</a><a id="8421" href="ContractAutomata.html#1920" class="Field">start</a> <a id="8427" href="Prelude.Ord.html#2635" class="Function Operator">&gt;ᵇ</a> <a id="8430" href="ContractAutomata.html#8302" class="Bound">payment</a> <a id="8438" class="Symbol">.</a><a id="8439" href="ContractAutomata.html#1059" class="Field">deadline</a><a id="8447" class="Symbol">)</a>
    <a id="8453" class="CatchallClause Symbol">_</a> <a id="8455" class="Symbol">→</a> <a id="8457" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>

<a id="8464" class="Comment">-- ** Soundness</a>

<a id="transition-sound"></a><a id="8481" href="ContractAutomata.html#8481" class="Function">transition-sound</a> <a id="8498" class="Symbol">:</a> <a id="8500" class="Symbol">∀</a> <a id="8502" class="Symbol">{</a><a id="8503" href="ContractAutomata.html#8503" class="Bound">s⁺</a> <a id="8506" class="Symbol">:</a> <a id="8508" href="ContractAutomata.html#2255" class="Record">Conf</a> <a id="8513" href="ContractAutomata.html#2891" class="Generalizable">s</a><a id="8514" class="Symbol">}</a> <a id="8516" class="Symbol">{</a><a id="8517" href="ContractAutomata.html#8517" class="Bound">l⁺</a> <a id="8520" class="Symbol">:</a> <a id="8522" href="ContractAutomata.html#2906" class="Generalizable">l</a> <a id="8524" href="ContractAutomata.html#1239" class="Field Operator">⁺</a><a id="8525" class="Symbol">}</a> <a id="8527" class="Symbol">{</a><a id="8528" href="ContractAutomata.html#8528" class="Bound">s⁺′</a> <a id="8532" class="Symbol">:</a> <a id="8534" href="ContractAutomata.html#2255" class="Record">Conf</a> <a id="8539" href="ContractAutomata.html#2893" class="Generalizable">s′</a><a id="8541" class="Symbol">}</a> <a id="8543" class="Symbol">{</a><a id="8544" href="ContractAutomata.html#8544" class="Bound">is</a> <a id="8547" class="Symbol">:</a> <a id="8549" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="8554" href="ContractAutomata.html#1768" class="Function">Message</a><a id="8561" class="Symbol">}</a> <a id="8563" class="Symbol">→</a>
  <a id="8567" class="Symbol">∀</a> <a id="8569" class="Symbol">(</a><a id="8570" href="ContractAutomata.html#8570" class="Bound">s→</a> <a id="8573" class="Symbol">:</a> <a id="8575" href="ContractAutomata.html#2891" class="Generalizable">s</a> <a id="8577" href="ContractAutomata.html#571" class="Datatype Operator">—[</a> <a id="8580" href="ContractAutomata.html#2906" class="Generalizable">l</a> <a id="8582" href="ContractAutomata.html#571" class="Datatype Operator">]→</a> <a id="8585" href="ContractAutomata.html#2893" class="Generalizable">s′</a><a id="8587" class="Symbol">)</a> <a id="8589" class="Symbol">→</a>
  <a id="8593" href="Prelude.InferenceRules.html#56118" class="Function Operator">∙</a> <a id="8595" href="ContractAutomata.html#4758" class="Function">transition</a> <a id="8606" href="ContractAutomata.html#8503" class="Bound">s⁺</a> <a id="8609" href="ContractAutomata.html#8517" class="Bound">l⁺</a> <a id="8612" href="ContractAutomata.html#8544" class="Bound">is</a> <a id="8615" href="ContractAutomata.html#2877" class="Generalizable">t</a> <a id="8617" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="8619" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="8624" class="Symbol">(</a><a id="8625" href="ContractAutomata.html#2893" class="Generalizable">s′</a> <a id="8628" class="InductiveConstructor Operator">,</a> <a id="8630" href="ContractAutomata.html#8570" class="Bound">s→</a> <a id="8633" class="InductiveConstructor Operator">,</a> <a id="8635" href="ContractAutomata.html#8528" class="Bound">s⁺′</a><a id="8638" class="Symbol">)</a>
    <a id="8644" href="Prelude.InferenceRules.html#12025" class="Function Operator">────────────────────────────────────────────────────────────────</a>
    <a id="8713" href="Data.Product.html#1369" class="Function">∃</a> <a id="8715" class="Symbol">λ</a> <a id="8717" class="Symbol">(</a><a id="8718" href="ContractAutomata.html#8718" class="Bound">d&lt;</a> <a id="8721" class="Symbol">:</a> <a id="8723" href="ContractAutomata.html#8503" class="Bound">s⁺</a> <a id="8726" class="Symbol">.</a><a id="8727" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="8736" class="Symbol">.</a><a id="8737" href="ContractAutomata.html#1941" class="Field">end</a> <a id="8741" href="Prelude.Ord.html#271" class="Field Operator">&lt;</a> <a id="8743" href="ContractAutomata.html#8528" class="Bound">s⁺′</a> <a id="8747" class="Symbol">.</a><a id="8748" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="8757" class="Symbol">.</a><a id="8758" href="ContractAutomata.html#1941" class="Field">end</a><a id="8761" class="Symbol">)</a>
    <a id="8767" class="Symbol">→</a> <a id="8769" class="Symbol">(</a><a id="8770" href="ContractAutomata.html#8503" class="Bound">s⁺</a> <a id="8773" href="ContractAutomata.html#3073" class="Datatype Operator">⇒⟨</a> <a id="8776" href="ContractAutomata.html#8517" class="Bound">l⁺</a> <a id="8779" href="ContractAutomata.html#3073" class="Datatype Operator">⟩</a> <a id="8781" href="ContractAutomata.html#8528" class="Bound">s⁺′</a><a id="8784" class="Symbol">)</a> <a id="8786" class="Symbol">⦃</a> <a id="8788" href="ContractAutomata.html#8570" class="Bound">s→</a> <a id="8791" class="Symbol">⦄</a> <a id="8793" class="Symbol">⦃</a> <a id="8795" href="ContractAutomata.html#8718" class="Bound">d&lt;</a> <a id="8798" class="Symbol">⦄</a>
    <a id="8804" class="Comment">-- × (s⁺′ .inputs ⊆ is)</a>
    <a id="8832" class="Comment">-- × T (validate (s⁺ .state) l⁺ s⁺′)</a>
<a id="8869" href="ContractAutomata.html#8481" class="Function">transition-sound</a> <a id="8886" class="Symbol">{</a><a id="8887" href="ContractAutomata.html#358" class="InductiveConstructor">Holding</a><a id="8894" class="Symbol">}{</a><a id="8896" href="ContractAutomata.html#473" class="InductiveConstructor">Propose</a><a id="8903" class="Symbol">}{</a><a id="8905" href="ContractAutomata.html#8905" class="Bound">s′</a><a id="8907" class="Symbol">}{</a><a id="8909" href="ContractAutomata.html#8909" class="Bound">t</a><a id="8910" class="Symbol">}{</a><a id="8912" href="ContractAutomata.html#8912" class="Bound">s⁺</a><a id="8914" class="Symbol">}{</a><a id="8916" href="ContractAutomata.html#1505" class="InductiveConstructor">Propose</a> <a id="8924" href="ContractAutomata.html#8924" class="Bound">payment</a><a id="8931" class="Symbol">}{</a><a id="8933" href="ContractAutomata.html#8933" class="Bound">s⁺′</a><a id="8936" class="Symbol">}{</a><a id="8938" href="ContractAutomata.html#8938" class="Bound">is</a><a id="8940" class="Symbol">}</a> <a id="8942" href="ContractAutomata.html#631" class="InductiveConstructor">Propose</a> <a id="8950" href="ContractAutomata.html#8950" class="Bound">tr≡</a>
  <a id="8956" class="Keyword">with</a> <a id="8961" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="8965" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> ← <a id="8972" href="ContractAutomata.html#8912" class="Bound">s⁺</a> <a id="8975" href="Prelude.DecEq.Core.html#156" class="Field Operator">≟</a> <a id="8977" class="Keyword">record</a> <a id="8984" class="Symbol">{</a><a id="8985" href="ContractAutomata.html#2054" class="Module">def</a><a id="8988" class="Symbol">;</a> <a id="8990" href="ContractAutomata.html#2313" class="Field">value</a> <a id="8996" class="Symbol">=</a> <a id="8998" href="ContractAutomata.html#8912" class="Bound">s⁺</a> <a id="9001" class="Symbol">.</a><a id="9002" href="ContractAutomata.html#2313" class="Field">value</a><a id="9007" class="Symbol">;</a> <a id="9009" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="9018" class="Symbol">=</a> <a id="9020" href="ContractAutomata.html#8912" class="Bound">s⁺</a> <a id="9023" class="Symbol">.</a><a id="9024" href="ContractAutomata.html#2396" class="Field">duration</a><a id="9032" class="Symbol">;</a> <a id="9034" href="ContractAutomata.html#2293" class="Field">state</a> <a id="9040" class="Symbol">=</a> <a id="9042" href="ContractAutomata.html#1310" class="InductiveConstructor">Holding</a><a id="9049" class="Symbol">}</a>
  <a id="9053" class="Keyword">with</a> <a id="9058" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="9062" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> ← <a id="9069" href="ContractAutomata.html#8938" class="Bound">is</a> <a id="9072" href="Prelude.DecEq.Core.html#156" class="Field Operator">≟</a> <a id="9074" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="9079" class="Keyword">with</a> <a id="9084" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="9088" href="ContractAutomata.html#9088" class="Bound">d&lt;</a> ← <a id="9093" href="ContractAutomata.html#8912" class="Bound">s⁺</a> <a id="9096" class="Symbol">.</a><a id="9097" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="9106" class="Symbol">.</a><a id="9107" href="ContractAutomata.html#1941" class="Field">end</a> <a id="9111" href="Prelude.Ord.html#2509" class="Function Operator">&lt;?</a> <a id="9114" href="ContractAutomata.html#8909" class="Bound">t</a> <a id="9116" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="9118" href="ContractAutomata.html#2548" class="Postulate">standardInterval</a>
  <a id="9137" class="Keyword">with</a> <a id="9142" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="9146" href="ContractAutomata.html#9146" class="Bound">p₁</a> ← <a id="9151" class="Number">0</a> <a id="9153" href="Prelude.Ord.html#2509" class="Function Operator">&lt;?</a> <a id="9156" href="ContractAutomata.html#8924" class="Bound">payment</a> <a id="9164" class="Symbol">.</a><a id="9165" href="ContractAutomata.html#1009" class="Field">amount</a>
  <a id="9174" class="Keyword">with</a> <a id="9179" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="9183" href="ContractAutomata.html#9183" class="Bound">p₂</a> ← <a id="9188" href="ContractAutomata.html#8924" class="Bound">payment</a> <a id="9196" class="Symbol">.</a><a id="9197" href="ContractAutomata.html#1009" class="Field">amount</a> <a id="9204" href="Prelude.Ord.html#540" class="Function Operator">≤?</a> <a id="9207" href="ContractAutomata.html#8912" class="Bound">s⁺</a> <a id="9210" class="Symbol">.</a><a id="9211" href="ContractAutomata.html#2313" class="Field">value</a>
  <a id="9219" class="Keyword">with</a> <a id="9224" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="9228" href="ContractAutomata.html#9228" class="Bound">p₃</a> ← <a id="9233" href="ContractAutomata.html#8924" class="Bound">payment</a> <a id="9241" class="Symbol">.</a><a id="9242" href="ContractAutomata.html#1059" class="Field">deadline</a> <a id="9251" href="Prelude.Ord.html#2617" class="Function Operator">&gt;?</a> <a id="9254" href="ContractAutomata.html#8909" class="Bound">t</a> <a id="9256" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="9258" href="ContractAutomata.html#2548" class="Postulate">standardInterval</a>
  <a id="9277" class="Keyword">with</a> <a id="9282" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> ← <a id="9289" href="ContractAutomata.html#8950" class="Bound">tr≡</a>
  <a id="9295" class="Symbol">=</a> <a id="9297" href="ContractAutomata.html#9088" class="Bound">d&lt;</a> <a id="9300" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9302" href="ContractAutomata.html#3238" class="InductiveConstructor">Propose</a> <a id="9310" href="ContractAutomata.html#9088" class="Bound">d&lt;</a> <a id="9313" href="ContractAutomata.html#9183" class="Bound">p₂</a> <a id="9316" href="ContractAutomata.html#9228" class="Bound">p₃</a>
<a id="9319" href="ContractAutomata.html#8481" class="Function">transition-sound</a> <a id="9336" class="Symbol">{</a><a id="9337" href="ContractAutomata.html#366" class="InductiveConstructor">Collecting</a><a id="9347" class="Symbol">}{</a><a id="9349" href="ContractAutomata.html#481" class="InductiveConstructor">Add</a><a id="9352" class="Symbol">}{</a><a id="9354" href="ContractAutomata.html#9354" class="Bound">s′</a><a id="9356" class="Symbol">}{</a><a id="9358" href="ContractAutomata.html#9358" class="Bound">t</a><a id="9359" class="Symbol">}{</a><a id="9361" href="ContractAutomata.html#9361" class="Bound">s⁺</a><a id="9363" class="Symbol">}{</a><a id="9365" href="ContractAutomata.html#1542" class="InductiveConstructor">Add</a> <a id="9369" href="ContractAutomata.html#9369" class="Bound">key</a><a id="9372" class="Symbol">}{</a><a id="9374" href="ContractAutomata.html#9374" class="Bound">s⁺′</a><a id="9377" class="Symbol">}{</a><a id="9379" href="ContractAutomata.html#9379" class="Bound">is</a><a id="9381" class="Symbol">}</a> <a id="9383" href="ContractAutomata.html#681" class="InductiveConstructor">Add</a> <a id="9387" href="ContractAutomata.html#9387" class="Bound">tr≡</a>
  <a id="9393" class="Keyword">with</a> <a id="9398" href="ContractAutomata.html#1340" class="InductiveConstructor">Collecting</a> <a id="9409" href="ContractAutomata.html#9409" class="Bound">payment</a> <a id="9417" href="ContractAutomata.html#9417" class="Bound">keys</a> ← <a id="9424" href="ContractAutomata.html#9361" class="Bound">s⁺</a> <a id="9427" class="Symbol">.</a><a id="9428" href="ContractAutomata.html#2293" class="Field">state</a> <a id="9434" class="Keyword">in</a> <a id="9437" class="Argument">st≡</a>
  <a id="9443" class="Keyword">with</a> <a id="9448" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="9452" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> ← <a id="9459" href="ContractAutomata.html#9379" class="Bound">is</a> <a id="9462" href="Prelude.DecEq.Core.html#156" class="Field Operator">≟</a> <a id="9464" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="9469" class="Keyword">with</a> <a id="9474" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="9478" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> ← <a id="9485" href="ContractAutomata.html#9361" class="Bound">s⁺</a> <a id="9488" class="Symbol">.</a><a id="9489" href="ContractAutomata.html#2335" class="Field">inputs</a> <a id="9496" href="Prelude.DecEq.Core.html#156" class="Field Operator">≟</a> <a id="9498" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="9503" class="Keyword">with</a> <a id="9508" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="9512" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> ← <a id="9519" href="ContractAutomata.html#9361" class="Bound">s⁺</a> <a id="9522" class="Symbol">.</a><a id="9523" href="ContractAutomata.html#2365" class="Field">outputs</a> <a id="9531" href="Prelude.DecEq.Core.html#156" class="Field Operator">≟</a> <a id="9533" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="9538" class="Keyword">with</a> <a id="9543" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="9547" href="ContractAutomata.html#9547" class="Bound">d&lt;</a> ← <a id="9552" href="ContractAutomata.html#9361" class="Bound">s⁺</a> <a id="9555" class="Symbol">.</a><a id="9556" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="9565" class="Symbol">.</a><a id="9566" href="ContractAutomata.html#1941" class="Field">end</a> <a id="9570" href="Prelude.Ord.html#2509" class="Function Operator">&lt;?</a> <a id="9573" href="ContractAutomata.html#9358" class="Bound">t</a> <a id="9575" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="9577" href="ContractAutomata.html#2548" class="Postulate">standardInterval</a>
  <a id="9596" class="Keyword">with</a> <a id="9601" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="9605" href="ContractAutomata.html#9605" class="Bound">k∈</a> ← <a id="9610" href="ContractAutomata.html#9369" class="Bound">key</a> <a id="9614" href="Prelude.Sets.AsUniqueLists.Core.html#2342" class="Function Operator">∈ˢ?</a> <a id="9618" href="ContractAutomata.html#2592" class="Postulate">authorizedKeys</a>
  <a id="9635" class="Keyword">with</a> <a id="9640" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> ← <a id="9647" href="ContractAutomata.html#9387" class="Bound">tr≡</a>
  <a id="9653" class="Keyword">rewrite</a> <a id="9661" href="ContractAutomata.html#9437" class="Bound">st≡</a>
  <a id="9667" class="Symbol">=</a> <a id="9669" href="ContractAutomata.html#9547" class="Bound">d&lt;</a> <a id="9672" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9674" href="ContractAutomata.html#3549" class="InductiveConstructor">Add</a> <a id="9678" href="ContractAutomata.html#9547" class="Bound">d&lt;</a> <a id="9681" href="ContractAutomata.html#9605" class="Bound">k∈</a>
<a id="9684" href="ContractAutomata.html#8481" class="Function">transition-sound</a> <a id="9701" class="Symbol">{</a><a id="9702" href="ContractAutomata.html#366" class="InductiveConstructor">Collecting</a><a id="9712" class="Symbol">}{</a><a id="9714" href="ContractAutomata.html#485" class="InductiveConstructor">Pay</a><a id="9717" class="Symbol">}{</a><a id="9719" href="ContractAutomata.html#9719" class="Bound">s′</a><a id="9721" class="Symbol">}{</a><a id="9723" href="ContractAutomata.html#9723" class="Bound">t</a><a id="9724" class="Symbol">}{</a><a id="9726" href="ContractAutomata.html#9726" class="Bound">s⁺</a><a id="9728" class="Symbol">}{</a><a id="9730" href="ContractAutomata.html#1575" class="InductiveConstructor">Pay</a><a id="9733" class="Symbol">}{</a><a id="9735" href="ContractAutomata.html#9735" class="Bound">s⁺′</a><a id="9738" class="Symbol">}{</a><a id="9740" href="ContractAutomata.html#9740" class="Bound">is</a><a id="9742" class="Symbol">}</a> <a id="9744" href="ContractAutomata.html#731" class="InductiveConstructor">Pay</a> <a id="9748" href="ContractAutomata.html#9748" class="Bound">tr≡</a>
  <a id="9754" class="Keyword">with</a> <a id="9759" href="ContractAutomata.html#1340" class="InductiveConstructor">Collecting</a> <a id="9770" href="ContractAutomata.html#9770" class="Bound">payment</a> <a id="9778" href="ContractAutomata.html#9778" class="Bound">keys</a> ← <a id="9785" href="ContractAutomata.html#9726" class="Bound">s⁺</a> <a id="9788" class="Symbol">.</a><a id="9789" href="ContractAutomata.html#2293" class="Field">state</a> <a id="9795" class="Keyword">in</a> <a id="9798" class="Argument">st≡</a>
  <a id="9804" class="Keyword">with</a> <a id="9809" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="9813" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> ← <a id="9820" href="ContractAutomata.html#9740" class="Bound">is</a> <a id="9823" href="Prelude.DecEq.Core.html#156" class="Field Operator">≟</a> <a id="9825" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="9830" class="Keyword">with</a> <a id="9835" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="9839" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> ← <a id="9846" href="ContractAutomata.html#9726" class="Bound">s⁺</a> <a id="9849" class="Symbol">.</a><a id="9850" href="ContractAutomata.html#2335" class="Field">inputs</a> <a id="9857" href="Prelude.DecEq.Core.html#156" class="Field Operator">≟</a> <a id="9859" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="9864" class="Keyword">with</a> <a id="9869" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="9873" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> ← <a id="9880" href="ContractAutomata.html#9726" class="Bound">s⁺</a> <a id="9883" class="Symbol">.</a><a id="9884" href="ContractAutomata.html#2365" class="Field">outputs</a> <a id="9892" href="Prelude.DecEq.Core.html#156" class="Field Operator">≟</a> <a id="9894" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="9899" class="Keyword">with</a> <a id="9904" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="9908" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> ← <a id="9915" href="ContractAutomata.html#9726" class="Bound">s⁺</a> <a id="9918" class="Symbol">.</a><a id="9919" href="ContractAutomata.html#2424" class="Field">signers</a> <a id="9927" href="Prelude.DecEq.Core.html#156" class="Field Operator">≟</a> <a id="9929" href="Prelude.Sets.AsUniqueLists.Core.html#2531" class="InductiveConstructor">∅</a>
  <a id="9933" class="Keyword">with</a> <a id="9938" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="9942" href="ContractAutomata.html#9942" class="Bound">d&lt;</a> ← <a id="9947" href="ContractAutomata.html#9726" class="Bound">s⁺</a> <a id="9950" class="Symbol">.</a><a id="9951" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="9960" class="Symbol">.</a><a id="9961" href="ContractAutomata.html#1941" class="Field">end</a> <a id="9965" href="Prelude.Ord.html#2509" class="Function Operator">&lt;?</a> <a id="9968" class="Symbol">(</a><a id="9969" href="ContractAutomata.html#9723" class="Bound">t</a> <a id="9971" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="9973" href="ContractAutomata.html#2548" class="Postulate">standardInterval</a><a id="9989" class="Symbol">)</a> <a id="9991" href="Data.Nat.Base.html#3157" class="Function Operator">⊓</a> <a id="9993" href="ContractAutomata.html#9770" class="Bound">payment</a> <a id="10001" class="Symbol">.</a><a id="10002" href="ContractAutomata.html#1059" class="Field">deadline</a>
  <a id="10013" class="Keyword">with</a> <a id="10018" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10022" href="ContractAutomata.html#10022" class="Bound">k&gt;</a> ← <a id="10027" href="Prelude.Measurable.html#320" class="Field Operator">∣</a> <a id="10029" href="ContractAutomata.html#9778" class="Bound">keys</a> <a id="10034" href="Prelude.Measurable.html#320" class="Field Operator">∣</a> <a id="10036" href="Prelude.Ord.html#648" class="Function Operator">≥?</a> <a id="10039" href="ContractAutomata.html#2626" class="Postulate">noRequiredSignatures</a>
  <a id="10062" class="Keyword">with</a> <a id="10067" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10071" href="ContractAutomata.html#10071" class="Bound">t&lt;</a> ← <a id="10076" href="ContractAutomata.html#9723" class="Bound">t</a> <a id="10078" href="Prelude.Ord.html#2509" class="Function Operator">&lt;?</a> <a id="10081" href="ContractAutomata.html#9770" class="Bound">payment</a> <a id="10089" class="Symbol">.</a><a id="10090" href="ContractAutomata.html#1059" class="Field">deadline</a>
  <a id="10101" class="Keyword">with</a> <a id="10106" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> ← <a id="10113" href="ContractAutomata.html#9748" class="Bound">tr≡</a>
  <a id="10119" class="Keyword">rewrite</a> <a id="10127" href="ContractAutomata.html#9798" class="Bound">st≡</a>
  <a id="10133" class="Symbol">=</a> <a id="10135" href="ContractAutomata.html#9942" class="Bound">d&lt;</a> <a id="10138" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10140" href="ContractAutomata.html#3925" class="InductiveConstructor">Pay</a> <a id="10144" href="ContractAutomata.html#9942" class="Bound">d&lt;</a> <a id="10147" href="ContractAutomata.html#10022" class="Bound">k&gt;</a> <a id="10150" class="Symbol">(</a><a id="10151" href="Data.Nat.Properties.html#33596" class="Function">Nat.m⊓n≤n</a> <a id="10161" class="Symbol">(</a><a id="10162" href="ContractAutomata.html#9723" class="Bound">t</a> <a id="10164" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="10166" href="ContractAutomata.html#2548" class="Postulate">standardInterval</a><a id="10182" class="Symbol">)</a> <a id="10184" class="Symbol">(</a><a id="10185" href="ContractAutomata.html#9770" class="Bound">payment</a> <a id="10193" class="Symbol">.</a><a id="10194" href="ContractAutomata.html#1059" class="Field">deadline</a><a id="10202" class="Symbol">))</a>
<a id="10205" href="ContractAutomata.html#8481" class="Function">transition-sound</a> <a id="10222" class="Symbol">{</a><a id="10223" href="ContractAutomata.html#366" class="InductiveConstructor">Collecting</a><a id="10233" class="Symbol">}{</a><a id="10235" href="ContractAutomata.html#489" class="InductiveConstructor">Cancel</a><a id="10241" class="Symbol">}{</a><a id="10243" href="ContractAutomata.html#10243" class="Bound">s′</a><a id="10245" class="Symbol">}{</a><a id="10247" href="ContractAutomata.html#10247" class="Bound">t</a><a id="10248" class="Symbol">}{</a><a id="10250" href="ContractAutomata.html#10250" class="Bound">s⁺</a><a id="10252" class="Symbol">}{</a><a id="10254" href="ContractAutomata.html#1598" class="InductiveConstructor">Cancel</a><a id="10260" class="Symbol">}{</a><a id="10262" href="ContractAutomata.html#10262" class="Bound">s⁺′</a><a id="10265" class="Symbol">}{</a><a id="10267" href="ContractAutomata.html#10267" class="Bound">is</a><a id="10269" class="Symbol">}</a> <a id="10271" href="ContractAutomata.html#778" class="InductiveConstructor">Cancel</a> <a id="10278" href="ContractAutomata.html#10278" class="Bound">tr≡</a>
  <a id="10284" class="Keyword">with</a> <a id="10289" href="ContractAutomata.html#1340" class="InductiveConstructor">Collecting</a> <a id="10300" href="ContractAutomata.html#10300" class="Bound">payment</a> <a id="10308" href="ContractAutomata.html#10308" class="Bound">keys</a> ← <a id="10315" href="ContractAutomata.html#10250" class="Bound">s⁺</a> <a id="10318" class="Symbol">.</a><a id="10319" href="ContractAutomata.html#2293" class="Field">state</a> <a id="10325" class="Keyword">in</a> <a id="10328" class="Argument">st≡</a>
  <a id="10334" class="Keyword">with</a> <a id="10339" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10343" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> ← <a id="10350" href="ContractAutomata.html#10267" class="Bound">is</a> <a id="10353" href="Prelude.DecEq.Core.html#156" class="Field Operator">≟</a> <a id="10355" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="10360" class="Keyword">with</a> <a id="10365" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10369" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> ← <a id="10376" href="ContractAutomata.html#10250" class="Bound">s⁺</a> <a id="10379" class="Symbol">.</a><a id="10380" href="ContractAutomata.html#2335" class="Field">inputs</a> <a id="10387" href="Prelude.DecEq.Core.html#156" class="Field Operator">≟</a> <a id="10389" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="10394" class="Keyword">with</a> <a id="10399" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10403" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> ← <a id="10410" href="ContractAutomata.html#10250" class="Bound">s⁺</a> <a id="10413" class="Symbol">.</a><a id="10414" href="ContractAutomata.html#2365" class="Field">outputs</a> <a id="10422" href="Prelude.DecEq.Core.html#156" class="Field Operator">≟</a> <a id="10424" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="10429" class="Keyword">with</a> <a id="10434" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10438" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> ← <a id="10445" href="ContractAutomata.html#10250" class="Bound">s⁺</a> <a id="10448" class="Symbol">.</a><a id="10449" href="ContractAutomata.html#2424" class="Field">signers</a> <a id="10457" href="Prelude.DecEq.Core.html#156" class="Field Operator">≟</a> <a id="10459" href="Prelude.Sets.AsUniqueLists.Core.html#2531" class="InductiveConstructor">∅</a>
  <a id="10463" class="Keyword">with</a> <a id="10468" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10472" href="ContractAutomata.html#10472" class="Bound">d&lt;</a> ← <a id="10477" href="ContractAutomata.html#10250" class="Bound">s⁺</a> <a id="10480" class="Symbol">.</a><a id="10481" href="ContractAutomata.html#2396" class="Field">duration</a> <a id="10490" class="Symbol">.</a><a id="10491" href="ContractAutomata.html#1941" class="Field">end</a> <a id="10495" href="Prelude.Ord.html#2509" class="Function Operator">&lt;?</a> <a id="10498" href="ContractAutomata.html#10247" class="Bound">t</a> <a id="10500" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="10502" href="ContractAutomata.html#2548" class="Postulate">standardInterval</a>
  <a id="10521" class="Keyword">with</a> <a id="10526" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10530" href="ContractAutomata.html#10530" class="Bound">t&lt;</a> ← <a id="10535" href="ContractAutomata.html#10247" class="Bound">t</a> <a id="10537" href="Prelude.Ord.html#2617" class="Function Operator">&gt;?</a> <a id="10540" href="ContractAutomata.html#10300" class="Bound">payment</a> <a id="10548" class="Symbol">.</a><a id="10549" href="ContractAutomata.html#1059" class="Field">deadline</a>
  <a id="10560" class="Keyword">with</a> <a id="10565" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> ← <a id="10572" href="ContractAutomata.html#10278" class="Bound">tr≡</a>
  <a id="10578" class="Keyword">rewrite</a> <a id="10586" href="ContractAutomata.html#10328" class="Bound">st≡</a>
  <a id="10592" class="Symbol">=</a> <a id="10594" href="ContractAutomata.html#10472" class="Bound">d&lt;</a> <a id="10597" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10599" href="ContractAutomata.html#4320" class="InductiveConstructor">Cancel</a> <a id="10606" href="ContractAutomata.html#10472" class="Bound">d&lt;</a> <a id="10609" href="ContractAutomata.html#10530" class="Bound">t&lt;</a>

<a id="10613" class="Comment">-- ** Completeness?</a>
</pre></body></html>